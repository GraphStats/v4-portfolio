module.exports=[30037,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0}),c.parseCookie=l,c.parse=l,c.stringifyCookie=function(a,b){let c=b?.encode||encodeURIComponent,d=[];for(let b of Object.keys(a)){let g=a[b];if(void 0===g)continue;if(!e.test(b))throw TypeError(`cookie name is invalid: ${b}`);let h=c(g);if(!f.test(h))throw TypeError(`cookie val is invalid: ${g}`);d.push(`${b}=${h}`)}return d.join("; ")},c.stringifySetCookie=m,c.serialize=m,c.parseSetCookie=function(a,b){let c=b?.decode||q,d=a.length,e=n(a,0,d),f=o(a,0,e),g=-1===f?{name:"",value:c(p(a,0,e))}:{name:p(a,0,f),value:c(p(a,f+1,e))},h=e+1;for(;h<d;){let b=n(a,h,d),c=o(a,h,b),e=-1===c?p(a,h,b):p(a,h,c),f=-1===c?void 0:p(a,c+1,b);switch(e.toLowerCase()){case"httponly":g.httpOnly=!0;break;case"secure":g.secure=!0;break;case"partitioned":g.partitioned=!0;break;case"domain":g.domain=f;break;case"path":g.path=f;break;case"max-age":f&&i.test(f)&&(g.maxAge=Number(f));break;case"expires":if(!f)break;let j=new Date(f);Number.isFinite(j.valueOf())&&(g.expires=j);break;case"priority":if(!f)break;let k=f.toLowerCase();("low"===k||"medium"===k||"high"===k)&&(g.priority=k);break;case"samesite":if(!f)break;let l=f.toLowerCase();("lax"===l||"strict"===l||"none"===l)&&(g.sameSite=l)}h=b+1}return g},c.stringifySetCookie=m,c.serialize=m;let e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,f=/^[\u0021-\u003A\u003C-\u007E]*$/,g=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,h=/^[\u0020-\u003A\u003D-\u007E]*$/,i=/^-?\d+$/,j=Object.prototype.toString,k=((d=function(){}).prototype=Object.create(null),d);function l(a,b){let c=new k,d=a.length;if(d<2)return c;let e=b?.decode||q,f=0;do{let b=o(a,f,d);if(-1===b)break;let g=n(a,f,d);if(b>g){f=a.lastIndexOf(";",b-1)+1;continue}let h=p(a,f,b);void 0===c[h]&&(c[h]=e(p(a,b+1,g))),f=g+1}while(f<d)return c}function m(a,b,c){let d="object"==typeof a?a:{...c,name:a,value:String(b)},i=("object"==typeof b?b:c)?.encode||encodeURIComponent;if(!e.test(d.name))throw TypeError(`argument name is invalid: ${d.name}`);let k=d.value?i(d.value):"";if(!f.test(k))throw TypeError(`argument val is invalid: ${d.value}`);let l=d.name+"="+k;if(void 0!==d.maxAge){if(!Number.isInteger(d.maxAge))throw TypeError(`option maxAge is invalid: ${d.maxAge}`);l+="; Max-Age="+d.maxAge}if(d.domain){if(!g.test(d.domain))throw TypeError(`option domain is invalid: ${d.domain}`);l+="; Domain="+d.domain}if(d.path){if(!h.test(d.path))throw TypeError(`option path is invalid: ${d.path}`);l+="; Path="+d.path}if(d.expires){var m;if(m=d.expires,"[object Date]"!==j.call(m)||!Number.isFinite(d.expires.valueOf()))throw TypeError(`option expires is invalid: ${d.expires}`);l+="; Expires="+d.expires.toUTCString()}if(d.httpOnly&&(l+="; HttpOnly"),d.secure&&(l+="; Secure"),d.partitioned&&(l+="; Partitioned"),d.priority)switch("string"==typeof d.priority?d.priority.toLowerCase():void 0){case"low":l+="; Priority=Low";break;case"medium":l+="; Priority=Medium";break;case"high":l+="; Priority=High";break;default:throw TypeError(`option priority is invalid: ${d.priority}`)}if(d.sameSite)switch("string"==typeof d.sameSite?d.sameSite.toLowerCase():d.sameSite){case!0:case"strict":l+="; SameSite=Strict";break;case"lax":l+="; SameSite=Lax";break;case"none":l+="; SameSite=None";break;default:throw TypeError(`option sameSite is invalid: ${d.sameSite}`)}return l}function n(a,b,c){let d=a.indexOf(";",b);return -1===d?c:d}function o(a,b,c){let d=a.indexOf("=",b);return d<c?d:-1}function p(a,b,c){let d=b,e=c;do{let b=a.charCodeAt(d);if(32!==b&&9!==b)break}while(++d<e)for(;e>d;){let b=a.charCodeAt(e-1);if(32!==b&&9!==b)break;e--}return a.slice(d,e)}function q(a){if(-1===a.indexOf("%"))return a;try{return decodeURIComponent(a)}catch(b){return a}}},99932,(a,b,c)=>{},14466,a=>{"use strict";let b,c,d,e,f;var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=a.i(13155),L=a.i(32488),M=a.i(45088),N=a.i(47833);let O=(0,N.default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),P=(0,N.default)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Q=(0,N.default)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]),R=(0,N.default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var S=a.i(77763),T=a.i(75133);let U=(0,N.default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),V=(0,N.default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var W=a.i(62828);function X(a,b,{checkForDefaultPrevented:c=!0}={}){return function(d){if(a?.(d),!1===c||!d.defaultPrevented)return b?.(d)}}var Y=a.i(14526);function Z(a,b=[]){let c=[],d=()=>{let b=c.map(a=>L.createContext(a));return function(c){let d=c?.[a]||b;return L.useMemo(()=>({[`__scope${a}`]:{...c,[a]:d}}),[c,d])}};return d.scopeName=a,[function(b,d){let e=L.createContext(d),f=c.length;c=[...c,d];let g=b=>{let{scope:c,children:d,...g}=b,h=c?.[a]?.[f]||e,i=L.useMemo(()=>g,Object.values(g));return(0,K.jsx)(h.Provider,{value:i,children:d})};return g.displayName=b+"Provider",[g,function(c,g){let h=g?.[a]?.[f]||e,i=L.useContext(h);if(i)return i;if(void 0!==d)return d;throw Error(`\`${c}\` must be used within \`${b}\``)}]},function(...a){let b=a[0];if(1===a.length)return b;let c=()=>{let c=a.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){let d=c.reduce((b,{useScope:c,scopeName:d})=>{let e=c(a)[`__scope${d}`];return{...b,...e}},{});return L.useMemo(()=>({[`__scope${b.scopeName}`]:d}),[d])}};return c.scopeName=b.scopeName,c}(d,...b)]}var $=globalThis?.document?L.useLayoutEffect:()=>{},_=L["useId".toString()]||(()=>void 0),aa=0;function ab(a){let[b,c]=L.useState(_());return $(()=>{a||c(a=>a??String(aa++))},[a]),a||(b?`radix-${b}`:"")}function ac(a){let b=L.useRef(a);return L.useEffect(()=>{b.current=a}),L.useMemo(()=>(...a)=>b.current?.(...a),[])}var ad=a.i(21513),ae="dismissableLayer.update",af=L.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ag=L.forwardRef((a,b)=>{let{disableOutsidePointerEvents:c=!1,onEscapeKeyDown:d,onPointerDownOutside:e,onFocusOutside:f,onInteractOutside:g,onDismiss:h,...i}=a,j=L.useContext(af),[k,l]=L.useState(null),m=k?.ownerDocument??globalThis?.document,[,n]=L.useState({}),o=(0,Y.useComposedRefs)(b,a=>l(a)),p=Array.from(j.layers),[q]=[...j.layersWithOutsidePointerEventsDisabled].slice(-1),r=p.indexOf(q),s=k?p.indexOf(k):-1,t=j.layersWithOutsidePointerEventsDisabled.size>0,u=s>=r,v=function(a,b=globalThis?.document){let c=ac(a),d=L.useRef(!1),e=L.useRef(()=>{});return L.useEffect(()=>{let a=a=>{if(a.target&&!d.current){let d=function(){ai("dismissableLayer.pointerDownOutside",c,f,{discrete:!0})},f={originalEvent:a};"touch"===a.pointerType?(b.removeEventListener("click",e.current),e.current=d,b.addEventListener("click",e.current,{once:!0})):d()}else b.removeEventListener("click",e.current);d.current=!1},f=window.setTimeout(()=>{b.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(f),b.removeEventListener("pointerdown",a),b.removeEventListener("click",e.current)}},[b,c]),{onPointerDownCapture:()=>d.current=!0}}(a=>{let b=a.target,c=[...j.branches].some(a=>a.contains(b));u&&!c&&(e?.(a),g?.(a),a.defaultPrevented||h?.())},m),w=function(a,b=globalThis?.document){let c=ac(a),d=L.useRef(!1);return L.useEffect(()=>{let a=a=>{a.target&&!d.current&&ai("dismissableLayer.focusOutside",c,{originalEvent:a},{discrete:!1})};return b.addEventListener("focusin",a),()=>b.removeEventListener("focusin",a)},[b,c]),{onFocusCapture:()=>d.current=!0,onBlurCapture:()=>d.current=!1}}(a=>{let b=a.target;![...j.branches].some(a=>a.contains(b))&&(f?.(a),g?.(a),a.defaultPrevented||h?.())},m);return!function(a,b=globalThis?.document){let c=ac(a);L.useEffect(()=>{let a=a=>{"Escape"===a.key&&c(a)};return b.addEventListener("keydown",a,{capture:!0}),()=>b.removeEventListener("keydown",a,{capture:!0})},[c,b])}(a=>{s===j.layers.size-1&&(d?.(a),!a.defaultPrevented&&h&&(a.preventDefault(),h()))},m),L.useEffect(()=>{if(k)return c&&(0===j.layersWithOutsidePointerEventsDisabled.size&&(x=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),j.layersWithOutsidePointerEventsDisabled.add(k)),j.layers.add(k),ah(),()=>{c&&1===j.layersWithOutsidePointerEventsDisabled.size&&(m.body.style.pointerEvents=x)}},[k,m,c,j]),L.useEffect(()=>()=>{k&&(j.layers.delete(k),j.layersWithOutsidePointerEventsDisabled.delete(k),ah())},[k,j]),L.useEffect(()=>{let a=()=>n({});return document.addEventListener(ae,a),()=>document.removeEventListener(ae,a)},[]),(0,K.jsx)(ad.Primitive.div,{...i,ref:o,style:{pointerEvents:t?u?"auto":"none":void 0,...a.style},onFocusCapture:X(a.onFocusCapture,w.onFocusCapture),onBlurCapture:X(a.onBlurCapture,w.onBlurCapture),onPointerDownCapture:X(a.onPointerDownCapture,v.onPointerDownCapture)})});function ah(){let a=new CustomEvent(ae);document.dispatchEvent(a)}function ai(a,b,c,{discrete:d}){let e=c.originalEvent.target,f=new CustomEvent(a,{bubbles:!1,cancelable:!0,detail:c});b&&e.addEventListener(a,b,{once:!0}),d?(0,ad.dispatchDiscreteCustomEvent)(e,f):e.dispatchEvent(f)}ag.displayName="DismissableLayer",L.forwardRef((a,b)=>{let c=L.useContext(af),d=L.useRef(null),e=(0,Y.useComposedRefs)(b,d);return L.useEffect(()=>{let a=d.current;if(a)return c.branches.add(a),()=>{c.branches.delete(a)}},[c.branches]),(0,K.jsx)(ad.Primitive.div,{...a,ref:e})}).displayName="DismissableLayerBranch";var aj="focusScope.autoFocusOnMount",ak="focusScope.autoFocusOnUnmount",al={bubbles:!1,cancelable:!0},am=L.forwardRef((a,b)=>{let{loop:c=!1,trapped:d=!1,onMountAutoFocus:e,onUnmountAutoFocus:f,...g}=a,[h,i]=L.useState(null),j=ac(e),k=ac(f),l=L.useRef(null),m=(0,Y.useComposedRefs)(b,a=>i(a)),n=L.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;L.useEffect(()=>{if(d){let a=function(a){if(n.paused||!h)return;let b=a.target;h.contains(b)?l.current=b:ap(l.current,{select:!0})},b=function(a){if(n.paused||!h)return;let b=a.relatedTarget;null!==b&&(h.contains(b)||ap(l.current,{select:!0}))};document.addEventListener("focusin",a),document.addEventListener("focusout",b);let c=new MutationObserver(function(a){if(document.activeElement===document.body)for(let b of a)b.removedNodes.length>0&&ap(h)});return h&&c.observe(h,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",a),document.removeEventListener("focusout",b),c.disconnect()}}},[d,h,n.paused]),L.useEffect(()=>{if(h){aq.add(n);let a=document.activeElement;if(!h.contains(a)){let b=new CustomEvent(aj,al);h.addEventListener(aj,j),h.dispatchEvent(b),b.defaultPrevented||(function(a,{select:b=!1}={}){let c=document.activeElement;for(let d of a)if(ap(d,{select:b}),document.activeElement!==c)return}(an(h).filter(a=>"A"!==a.tagName),{select:!0}),document.activeElement===a&&ap(h))}return()=>{h.removeEventListener(aj,j),setTimeout(()=>{let b=new CustomEvent(ak,al);h.addEventListener(ak,k),h.dispatchEvent(b),b.defaultPrevented||ap(a??document.body,{select:!0}),h.removeEventListener(ak,k),aq.remove(n)},0)}}},[h,j,k,n]);let o=L.useCallback(a=>{if(!c&&!d||n.paused)return;let b="Tab"===a.key&&!a.altKey&&!a.ctrlKey&&!a.metaKey,e=document.activeElement;if(b&&e){var f;let b,d=a.currentTarget,[g,h]=[ao(b=an(f=d),f),ao(b.reverse(),f)];g&&h?a.shiftKey||e!==h?a.shiftKey&&e===g&&(a.preventDefault(),c&&ap(h,{select:!0})):(a.preventDefault(),c&&ap(g,{select:!0})):e===d&&a.preventDefault()}},[c,d,n.paused]);return(0,K.jsx)(ad.Primitive.div,{tabIndex:-1,...g,ref:m,onKeyDown:o})});function an(a){let b=[],c=document.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{let b="INPUT"===a.tagName&&"hidden"===a.type;return a.disabled||a.hidden||b?NodeFilter.FILTER_SKIP:a.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;c.nextNode();)b.push(c.currentNode);return b}function ao(a,b){for(let c of a)if(!function(a,{upTo:b}){if("hidden"===getComputedStyle(a).visibility)return!0;for(;a&&(void 0===b||a!==b);){if("none"===getComputedStyle(a).display)return!0;a=a.parentElement}return!1}(c,{upTo:b}))return c}function ap(a,{select:b=!1}={}){if(a&&a.focus){var c;let d=document.activeElement;a.focus({preventScroll:!0}),a!==d&&(c=a)instanceof HTMLInputElement&&"select"in c&&b&&a.select()}}am.displayName="FocusScope";var aq=(f=[],{add(a){let b=f[0];a!==b&&b?.pause(),(f=ar(f,a)).unshift(a)},remove(a){f=ar(f,a),f[0]?.resume()}});function ar(a,b){let c=[...a],d=c.indexOf(b);return -1!==d&&c.splice(d,1),c}var as=a.i(75737),at=L.forwardRef((a,b)=>{let{container:c,...d}=a,[e,f]=L.useState(!1);$(()=>f(!0),[]);let g=c||e&&globalThis?.document?.body;return g?as.default.createPortal((0,K.jsx)(ad.Primitive.div,{...d,ref:b}),g):null});at.displayName="Portal";var au=a=>{var b;let c,d,{present:e,children:f}=a,g=function(a){var b,c;let[d,e]=L.useState(),f=L.useRef({}),g=L.useRef(a),h=L.useRef("none"),[i,j]=(b=a?"mounted":"unmounted",c={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},L.useReducer((a,b)=>c[a][b]??a,b));return L.useEffect(()=>{let a=av(f.current);h.current="mounted"===i?a:"none"},[i]),$(()=>{let b=f.current,c=g.current;if(c!==a){let d=h.current,e=av(b);a?j("MOUNT"):"none"===e||b?.display==="none"?j("UNMOUNT"):c&&d!==e?j("ANIMATION_OUT"):j("UNMOUNT"),g.current=a}},[a,j]),$(()=>{if(d){let a,b=d.ownerDocument.defaultView??window,c=c=>{let e=av(f.current).includes(c.animationName);if(c.target===d&&e&&(j("ANIMATION_END"),!g.current)){let c=d.style.animationFillMode;d.style.animationFillMode="forwards",a=b.setTimeout(()=>{"forwards"===d.style.animationFillMode&&(d.style.animationFillMode=c)})}},e=a=>{a.target===d&&(h.current=av(f.current))};return d.addEventListener("animationstart",e),d.addEventListener("animationcancel",c),d.addEventListener("animationend",c),()=>{b.clearTimeout(a),d.removeEventListener("animationstart",e),d.removeEventListener("animationcancel",c),d.removeEventListener("animationend",c)}}j("ANIMATION_END")},[d,j]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:L.useCallback(a=>{a&&(f.current=getComputedStyle(a)),e(a)},[])}}(e),h="function"==typeof f?f({present:g.isPresent}):L.Children.only(f),i=(0,Y.useComposedRefs)(g.ref,(b=h,(d=(c=Object.getOwnPropertyDescriptor(b.props,"ref")?.get)&&"isReactWarning"in c&&c.isReactWarning)?b.ref:(d=(c=Object.getOwnPropertyDescriptor(b,"ref")?.get)&&"isReactWarning"in c&&c.isReactWarning)?b.props.ref:b.props.ref||b.ref));return"function"==typeof f||g.isPresent?L.cloneElement(h,{ref:i}):null};function av(a){return a?.animationName||"none"}au.displayName="Presence";var aw=0;function ax(){let a=document.createElement("span");return a.setAttribute("data-radix-focus-guard",""),a.tabIndex=0,a.style.outline="none",a.style.opacity="0",a.style.position="fixed",a.style.pointerEvents="none",a}var ay=function(){return(ay=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)};function az(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c}var aA=("function"==typeof SuppressedError&&SuppressedError,"right-scroll-bar-position"),aB="width-before-scroll-bar";function aC(a,b){return"function"==typeof a?a(b):a&&(a.current=b),a}var aD=L.useEffect,aE=new WeakMap,aF=(void 0===g&&(g={}),(void 0===h&&(h=function(a){return a}),i=[],j=!1,k={read:function(){if(j)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return i.length?i[i.length-1]:null},useMedium:function(a){var b=h(a,j);return i.push(b),function(){i=i.filter(function(a){return a!==b})}},assignSyncMedium:function(a){for(j=!0;i.length;){var b=i;i=[],b.forEach(a)}i={push:function(b){return a(b)},filter:function(){return i}}},assignMedium:function(a){j=!0;var b=[];if(i.length){var c=i;i=[],c.forEach(a),b=i}var d=function(){var c=b;b=[],c.forEach(a)},e=function(){return Promise.resolve().then(d)};e(),i={push:function(a){b.push(a),e()},filter:function(a){return b=b.filter(a),i}}}}).options=ay({async:!0,ssr:!1},g),k),aG=function(){},aH=L.forwardRef(function(a,b){var c,d,e,f,g=L.useRef(null),h=L.useState({onScrollCapture:aG,onWheelCapture:aG,onTouchMoveCapture:aG}),i=h[0],j=h[1],k=a.forwardProps,l=a.children,m=a.className,n=a.removeScrollBar,o=a.enabled,p=a.shards,q=a.sideCar,r=a.noRelative,s=a.noIsolation,t=a.inert,u=a.allowPinchZoom,v=a.as,w=a.gapMode,x=az(a,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),y=(c=[g,b],d=function(a){return c.forEach(function(b){return aC(b,a)})},(e=(0,L.useState)(function(){return{value:null,callback:d,facade:{get current(){return e.value},set current(value){var a=e.value;a!==value&&(e.value=value,e.callback(value,a))}}}})[0]).callback=d,f=e.facade,aD(function(){var a=aE.get(f);if(a){var b=new Set(a),d=new Set(c),e=f.current;b.forEach(function(a){d.has(a)||aC(a,null)}),d.forEach(function(a){b.has(a)||aC(a,e)})}aE.set(f,c)},[c]),f),z=ay(ay({},x),i);return L.createElement(L.Fragment,null,o&&L.createElement(q,{sideCar:aF,removeScrollBar:n,shards:p,noRelative:r,noIsolation:s,inert:t,setCallbacks:j,allowPinchZoom:!!u,lockRef:g,gapMode:w}),k?L.cloneElement(L.Children.only(l),ay(ay({},z),{ref:y})):L.createElement(void 0===v?"div":v,ay({},z,{className:m,ref:y}),l))});aH.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},aH.classNames={fullWidth:aB,zeroRight:aA};var aI=function(a){var b=a.sideCar,c=az(a,["sideCar"]);if(!b)throw Error("Sidecar: please provide `sideCar` property to import the right car");var d=b.read();if(!d)throw Error("Sidecar medium not found");return L.createElement(d,ay({},c))};aI.isSideCarExport=!0;var aJ=function(){var a=0,b=null;return{add:function(c){if(0==a&&(b=function(){if(!document)return null;var a=document.createElement("style");a.type="text/css";var b=y||("undefined"!=typeof __webpack_nonce__?__webpack_nonce__:void 0);return b&&a.setAttribute("nonce",b),a}())){var d,e;(d=b).styleSheet?d.styleSheet.cssText=c:d.appendChild(document.createTextNode(c)),e=b,(document.head||document.getElementsByTagName("head")[0]).appendChild(e)}a++},remove:function(){--a||!b||(b.parentNode&&b.parentNode.removeChild(b),b=null)}}},aK=function(){var a=aJ();return function(b,c){L.useEffect(function(){return a.add(b),function(){a.remove()}},[b&&c])}},aL=function(){var a=aK();return function(b){return a(b.styles,b.dynamic),null}},aM={left:0,top:0,right:0,gap:0},aN=aL(),aO="data-scroll-locked",aP=function(a,b,c,d){var e=a.left,f=a.top,g=a.right,h=a.gap;return void 0===c&&(c="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(d,";\n   padding-right: ").concat(h,"px ").concat(d,";\n  }\n  body[").concat(aO,"] {\n    overflow: hidden ").concat(d,";\n    overscroll-behavior: contain;\n    ").concat([b&&"position: relative ".concat(d,";"),"margin"===c&&"\n    padding-left: ".concat(e,"px;\n    padding-top: ").concat(f,"px;\n    padding-right: ").concat(g,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(h,"px ").concat(d,";\n    "),"padding"===c&&"padding-right: ".concat(h,"px ").concat(d,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(aA," {\n    right: ").concat(h,"px ").concat(d,";\n  }\n  \n  .").concat(aB," {\n    margin-right: ").concat(h,"px ").concat(d,";\n  }\n  \n  .").concat(aA," .").concat(aA," {\n    right: 0 ").concat(d,";\n  }\n  \n  .").concat(aB," .").concat(aB," {\n    margin-right: 0 ").concat(d,";\n  }\n  \n  body[").concat(aO,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(h,"px;\n  }\n")},aQ=function(){var a=parseInt(document.body.getAttribute(aO)||"0",10);return isFinite(a)?a:0},aR=function(){L.useEffect(function(){return document.body.setAttribute(aO,(aQ()+1).toString()),function(){var a=aQ()-1;a<=0?document.body.removeAttribute(aO):document.body.setAttribute(aO,a.toString())}},[])},aS=function(a){var b=a.noRelative,c=a.noImportant,d=a.gapMode,e=void 0===d?"margin":d;aR();var f=L.useMemo(function(){return void 0===e,aM},[e]);return L.createElement(aN,{styles:aP(f,!b,e,c?"":"!important")})},aT=function(a,b){if(!(a instanceof Element))return!1;var c=window.getComputedStyle(a);return"hidden"!==c[b]&&(c.overflowY!==c.overflowX||"TEXTAREA"===a.tagName||"visible"!==c[b])},aU=function(a,b){var c=b.ownerDocument,d=b;do{if("undefined"!=typeof ShadowRoot&&d instanceof ShadowRoot&&(d=d.host),aV(a,d)){var e=aW(a,d);if(e[1]>e[2])return!0}d=d.parentNode}while(d&&d!==c.body)return!1},aV=function(a,b){return"v"===a?aT(b,"overflowY"):aT(b,"overflowX")},aW=function(a,b){return"v"===a?[b.scrollTop,b.scrollHeight,b.clientHeight]:[b.scrollLeft,b.scrollWidth,b.clientWidth]},aX=function(a,b,c,d,e){var f,g=(f=window.getComputedStyle(b).direction,"h"===a&&"rtl"===f?-1:1),h=g*d,i=c.target,j=b.contains(i),k=!1,l=h>0,m=0,n=0;do{if(!i)break;var o=aW(a,i),p=o[0],q=o[1]-o[2]-g*p;(p||q)&&aV(a,i)&&(m+=q,n+=p);var r=i.parentNode;i=r&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r.host:r}while(!j&&i!==document.body||j&&(b.contains(i)||b===i))return l&&(e&&1>Math.abs(m)||!e&&h>m)?k=!0:!l&&(e&&1>Math.abs(n)||!e&&-h>n)&&(k=!0),k},aY=function(a){return"changedTouches"in a?[a.changedTouches[0].clientX,a.changedTouches[0].clientY]:[0,0]},aZ=function(a){return[a.deltaX,a.deltaY]},a$=function(a){return a&&"current"in a?a.current:a},a_=0,a0=[];let a1=(l=function(a){var b=L.useRef([]),c=L.useRef([0,0]),d=L.useRef(),e=L.useState(a_++)[0],f=L.useState(aL)[0],g=L.useRef(a);L.useEffect(function(){g.current=a},[a]),L.useEffect(function(){if(a.inert){document.body.classList.add("block-interactivity-".concat(e));var b=(function(a,b,c){if(c||2==arguments.length)for(var d,e=0,f=b.length;e<f;e++)!d&&e in b||(d||(d=Array.prototype.slice.call(b,0,e)),d[e]=b[e]);return a.concat(d||Array.prototype.slice.call(b))})([a.lockRef.current],(a.shards||[]).map(a$),!0).filter(Boolean);return b.forEach(function(a){return a.classList.add("allow-interactivity-".concat(e))}),function(){document.body.classList.remove("block-interactivity-".concat(e)),b.forEach(function(a){return a.classList.remove("allow-interactivity-".concat(e))})}}},[a.inert,a.lockRef.current,a.shards]);var h=L.useCallback(function(a,b){if("touches"in a&&2===a.touches.length||"wheel"===a.type&&a.ctrlKey)return!g.current.allowPinchZoom;var e,f=aY(a),h=c.current,i="deltaX"in a?a.deltaX:h[0]-f[0],j="deltaY"in a?a.deltaY:h[1]-f[1],k=a.target,l=Math.abs(i)>Math.abs(j)?"h":"v";if("touches"in a&&"h"===l&&"range"===k.type)return!1;var m=window.getSelection(),n=m&&m.anchorNode;if(n&&(n===k||n.contains(k)))return!1;var o=aU(l,k);if(!o)return!0;if(o?e=l:(e="v"===l?"h":"v",o=aU(l,k)),!o)return!1;if(!d.current&&"changedTouches"in a&&(i||j)&&(d.current=e),!e)return!0;var p=d.current||e;return aX(p,b,a,"h"===p?i:j,!0)},[]),i=L.useCallback(function(a){if(a0.length&&a0[a0.length-1]===f){var c="deltaY"in a?aZ(a):aY(a),d=b.current.filter(function(b){var d;return b.name===a.type&&(b.target===a.target||a.target===b.shadowParent)&&(d=b.delta,d[0]===c[0]&&d[1]===c[1])})[0];if(d&&d.should){a.cancelable&&a.preventDefault();return}if(!d){var e=(g.current.shards||[]).map(a$).filter(Boolean).filter(function(b){return b.contains(a.target)});(e.length>0?h(a,e[0]):!g.current.noIsolation)&&a.cancelable&&a.preventDefault()}}},[]),j=L.useCallback(function(a,c,d,e){var f={name:a,delta:c,target:d,should:e,shadowParent:function(a){for(var b=null;null!==a;)a instanceof ShadowRoot&&(b=a.host,a=a.host),a=a.parentNode;return b}(d)};b.current.push(f),setTimeout(function(){b.current=b.current.filter(function(a){return a!==f})},1)},[]),k=L.useCallback(function(a){c.current=aY(a),d.current=void 0},[]),l=L.useCallback(function(b){j(b.type,aZ(b),b.target,h(b,a.lockRef.current))},[]),m=L.useCallback(function(b){j(b.type,aY(b),b.target,h(b,a.lockRef.current))},[]);L.useEffect(function(){return a0.push(f),a.setCallbacks({onScrollCapture:l,onWheelCapture:l,onTouchMoveCapture:m}),document.addEventListener("wheel",i,!1),document.addEventListener("touchmove",i,!1),document.addEventListener("touchstart",k,!1),function(){a0=a0.filter(function(a){return a!==f}),document.removeEventListener("wheel",i,!1),document.removeEventListener("touchmove",i,!1),document.removeEventListener("touchstart",k,!1)}},[]);var n=a.removeScrollBar,o=a.inert;return L.createElement(L.Fragment,null,o?L.createElement(f,{styles:"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")}):null,n?L.createElement(aS,{noRelative:a.noRelative,gapMode:a.gapMode}):null)},aF.useMedium(l),aI);var a2=L.forwardRef(function(a,b){return L.createElement(aH,ay({},a,{ref:b,sideCar:a1}))});a2.classNames=aH.classNames;var a3=new WeakMap,a4=new WeakMap,a5={},a6=0,a7=function(a){return a&&(a.host||a7(a.parentNode))},a8=function(a,b,c,d){var e=(Array.isArray(a)?a:[a]).map(function(a){if(b.contains(a))return a;var c=a7(a);return c&&b.contains(c)?c:(console.error("aria-hidden",a,"in not contained inside",b,". Doing nothing"),null)}).filter(function(a){return!!a});a5[c]||(a5[c]=new WeakMap);var f=a5[c],g=[],h=new Set,i=new Set(e),j=function(a){!a||h.has(a)||(h.add(a),j(a.parentNode))};e.forEach(j);var k=function(a){!a||i.has(a)||Array.prototype.forEach.call(a.children,function(a){if(h.has(a))k(a);else try{var b=a.getAttribute(d),e=null!==b&&"false"!==b,i=(a3.get(a)||0)+1,j=(f.get(a)||0)+1;a3.set(a,i),f.set(a,j),g.push(a),1===i&&e&&a4.set(a,!0),1===j&&a.setAttribute(c,"true"),e||a.setAttribute(d,"true")}catch(b){console.error("aria-hidden: cannot operate on ",a,b)}})};return k(b),h.clear(),a6++,function(){g.forEach(function(a){var b=a3.get(a)-1,e=f.get(a)-1;a3.set(a,b),f.set(a,e),b||(a4.has(a)||a.removeAttribute(d),a4.delete(a)),e||a.removeAttribute(c)}),--a6||(a3=new WeakMap,a3=new WeakMap,a4=new WeakMap,a5={})}},a9=function(a,b,c){void 0===c&&(c="data-aria-hidden");var d=Array.from(Array.isArray(a)?a:[a]),e=b||("undefined"==typeof document?null:(Array.isArray(a)?a[0]:a).ownerDocument.body);return e?(d.push.apply(d,Array.from(e.querySelectorAll("[aria-live], script"))),a8(d,e,c,"aria-hidden")):function(){return null}},ba=a.i(75306),bb="Dialog",[bc,bd]=Z(bb),[be,bf]=bc(bb),bg=a=>{let{__scopeDialog:b,children:c,open:d,defaultOpen:e,onOpenChange:f,modal:g=!0}=a,h=L.useRef(null),i=L.useRef(null),[j=!1,k]=function({prop:a,defaultProp:b,onChange:c=()=>{}}){let[d,e]=function({defaultProp:a,onChange:b}){let c=L.useState(a),[d]=c,e=L.useRef(d),f=ac(b);return L.useEffect(()=>{e.current!==d&&(f(d),e.current=d)},[d,e,f]),c}({defaultProp:b,onChange:c}),f=void 0!==a,g=f?a:d,h=ac(c);return[g,L.useCallback(b=>{if(f){let c="function"==typeof b?b(a):b;c!==a&&h(c)}else e(b)},[f,a,e,h])]}({prop:d,defaultProp:e,onChange:f});return(0,K.jsx)(be,{scope:b,triggerRef:h,contentRef:i,contentId:ab(),titleId:ab(),descriptionId:ab(),open:j,onOpenChange:k,onOpenToggle:L.useCallback(()=>k(a=>!a),[k]),modal:g,children:c})};bg.displayName=bb;var bh="DialogTrigger",bi=L.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=bf(bh,c),f=(0,Y.useComposedRefs)(b,e.triggerRef);return(0,K.jsx)(ad.Primitive.button,{type:"button","aria-haspopup":"dialog","aria-expanded":e.open,"aria-controls":e.contentId,"data-state":bB(e.open),...d,ref:f,onClick:X(a.onClick,e.onOpenToggle)})});bi.displayName=bh;var bj="DialogPortal",[bk,bl]=bc(bj,{forceMount:void 0}),bm=a=>{let{__scopeDialog:b,forceMount:c,children:d,container:e}=a,f=bf(bj,b);return(0,K.jsx)(bk,{scope:b,forceMount:c,children:L.Children.map(d,a=>(0,K.jsx)(au,{present:c||f.open,children:(0,K.jsx)(at,{asChild:!0,container:e,children:a})}))})};bm.displayName=bj;var bn="DialogOverlay",bo=L.forwardRef((a,b)=>{let c=bl(bn,a.__scopeDialog),{forceMount:d=c.forceMount,...e}=a,f=bf(bn,a.__scopeDialog);return f.modal?(0,K.jsx)(au,{present:d||f.open,children:(0,K.jsx)(bp,{...e,ref:b})}):null});bo.displayName=bn;var bp=L.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=bf(bn,c);return(0,K.jsx)(a2,{as:ba.Slot,allowPinchZoom:!0,shards:[e.contentRef],children:(0,K.jsx)(ad.Primitive.div,{"data-state":bB(e.open),...d,ref:b,style:{pointerEvents:"auto",...d.style}})})}),bq="DialogContent",br=L.forwardRef((a,b)=>{let c=bl(bq,a.__scopeDialog),{forceMount:d=c.forceMount,...e}=a,f=bf(bq,a.__scopeDialog);return(0,K.jsx)(au,{present:d||f.open,children:f.modal?(0,K.jsx)(bs,{...e,ref:b}):(0,K.jsx)(bt,{...e,ref:b})})});br.displayName=bq;var bs=L.forwardRef((a,b)=>{let c=bf(bq,a.__scopeDialog),d=L.useRef(null),e=(0,Y.useComposedRefs)(b,c.contentRef,d);return L.useEffect(()=>{let a=d.current;if(a)return a9(a)},[]),(0,K.jsx)(bu,{...a,ref:e,trapFocus:c.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:X(a.onCloseAutoFocus,a=>{a.preventDefault(),c.triggerRef.current?.focus()}),onPointerDownOutside:X(a.onPointerDownOutside,a=>{let b=a.detail.originalEvent,c=0===b.button&&!0===b.ctrlKey;(2===b.button||c)&&a.preventDefault()}),onFocusOutside:X(a.onFocusOutside,a=>a.preventDefault())})}),bt=L.forwardRef((a,b)=>{let c=bf(bq,a.__scopeDialog),d=L.useRef(!1),e=L.useRef(!1);return(0,K.jsx)(bu,{...a,ref:b,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:b=>{a.onCloseAutoFocus?.(b),b.defaultPrevented||(d.current||c.triggerRef.current?.focus(),b.preventDefault()),d.current=!1,e.current=!1},onInteractOutside:b=>{a.onInteractOutside?.(b),b.defaultPrevented||(d.current=!0,"pointerdown"===b.detail.originalEvent.type&&(e.current=!0));let f=b.target;c.triggerRef.current?.contains(f)&&b.preventDefault(),"focusin"===b.detail.originalEvent.type&&e.current&&b.preventDefault()}})}),bu=L.forwardRef((a,b)=>{let{__scopeDialog:c,trapFocus:d,onOpenAutoFocus:e,onCloseAutoFocus:f,...g}=a,h=bf(bq,c),i=L.useRef(null),j=(0,Y.useComposedRefs)(b,i);return L.useEffect(()=>{let a=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",a[0]??ax()),document.body.insertAdjacentElement("beforeend",a[1]??ax()),aw++,()=>{1===aw&&document.querySelectorAll("[data-radix-focus-guard]").forEach(a=>a.remove()),aw--}},[]),(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(am,{asChild:!0,loop:!0,trapped:d,onMountAutoFocus:e,onUnmountAutoFocus:f,children:(0,K.jsx)(ag,{role:"dialog",id:h.contentId,"aria-describedby":h.descriptionId,"aria-labelledby":h.titleId,"data-state":bB(h.open),...g,ref:j,onDismiss:()=>h.onOpenChange(!1)})}),(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(bF,{titleId:h.titleId}),(0,K.jsx)(bG,{contentRef:i,descriptionId:h.descriptionId})]})]})}),bv="DialogTitle",bw=L.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=bf(bv,c);return(0,K.jsx)(ad.Primitive.h2,{id:e.titleId,...d,ref:b})});bw.displayName=bv;var bx="DialogDescription",by=L.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=bf(bx,c);return(0,K.jsx)(ad.Primitive.p,{id:e.descriptionId,...d,ref:b})});by.displayName=bx;var bz="DialogClose",bA=L.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=bf(bz,c);return(0,K.jsx)(ad.Primitive.button,{type:"button",...d,ref:b,onClick:X(a.onClick,()=>e.onOpenChange(!1))})});function bB(a){return a?"open":"closed"}bA.displayName=bz;var bC="DialogTitleWarning",[bD,bE]=(m={contentName:bq,titleName:bv,docsSlug:"dialog"},d=L.createContext(m),(e=a=>{let{children:b,...c}=a,e=L.useMemo(()=>c,Object.values(c));return(0,K.jsx)(d.Provider,{value:e,children:b})}).displayName=bC+"Provider",[e,function(a){let b=L.useContext(d);if(b)return b;if(void 0!==m)return m;throw Error(`\`${a}\` must be used within \`${bC}\``)}]),bF=({titleId:a})=>{let b=bE(bC),c=`\`${b.contentName}\` requires a \`${b.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${b.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${b.docsSlug}`;return L.useEffect(()=>{a&&(document.getElementById(a)||console.error(c))},[c,a]),null},bG=({contentRef:a,descriptionId:b})=>{let c=bE("DialogDescriptionWarning"),d=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${c.contentName}}.`;return L.useEffect(()=>{let c=a.current?.getAttribute("aria-describedby");b&&c&&(document.getElementById(b)||console.warn(d))},[d,a,b]),null},bH=a.i(85467),bH=bH,bI=a.i(51692);function bJ({...a}){return(0,K.jsx)(bg,{"data-slot":"dialog",...a})}function bK({...a}){return(0,K.jsx)(bm,{"data-slot":"dialog-portal",...a})}function bL({className:a,...b}){return(0,K.jsx)(bo,{"data-slot":"dialog-overlay",className:(0,bI.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...b})}function bM({className:a,children:b,showCloseButton:c=!0,...d}){return(0,K.jsxs)(bK,{"data-slot":"dialog-portal",children:[(0,K.jsx)(bL,{}),(0,K.jsxs)(br,{"data-slot":"dialog-content",className:(0,bI.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...d,children:[b,c&&(0,K.jsxs)(bA,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,K.jsx)(bH.default,{}),(0,K.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function bN({className:a,...b}){return(0,K.jsx)("div",{"data-slot":"dialog-header",className:(0,bI.cn)("flex flex-col gap-2 text-center sm:text-left",a),...b})}function bO({className:a,...b}){return(0,K.jsx)(bw,{"data-slot":"dialog-title",className:(0,bI.cn)("text-lg leading-none font-semibold",a),...b})}function bP({className:a,...b}){return(0,K.jsx)(by,{"data-slot":"dialog-description",className:(0,bI.cn)("text-muted-foreground text-sm",a),...b})}var bQ=a.i(92974),bR=a.i(95863);function bS({className:a,...b}){return(0,K.jsx)("textarea",{"data-slot":"textarea",className:(0,bI.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...b})}var bT=a.i(84062),bU=(0,bT.createServerReference)("40d4d8067242e6f9c1720b87a3a9c21b6060117e6a",bT.callServer,void 0,bT.findSourceMapURL,"createProject"),bV=(0,bT.createServerReference)("60bfb56a6b8bc00792e1e67c8573a4668abe23c56f",bT.callServer,void 0,bT.findSourceMapURL,"updateProject"),bW=a.i(67983);function bX({project:a,onSuccess:b}){let[c,d]=(0,L.useState)(!1),[e,f]=(0,L.useState)(null),g=(0,bW.useRouter)(),h=async c=>{c.preventDefault(),d(!0),f(null);let e=new FormData(c.currentTarget);try{let c=a?await bV(a.id,e):await bU(e);if(!c.success){f(c.error||"An error occurred"),d(!1);return}g.refresh(),b?.()}catch(a){f("An unexpected error occurred"),d(!1)}};return(0,K.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[(0,K.jsxs)("div",{className:"space-y-2",children:[(0,K.jsx)(bR.Label,{htmlFor:"title",children:"Title *"}),(0,K.jsx)(bQ.Input,{id:"title",name:"title",defaultValue:a?.title,required:!0})]}),(0,K.jsxs)("div",{className:"space-y-2",children:[(0,K.jsx)(bR.Label,{htmlFor:"description",children:"Description *"}),(0,K.jsx)(bS,{id:"description",name:"description",defaultValue:a?.description,required:!0,rows:4})]}),(0,K.jsxs)("div",{className:"space-y-2",children:[(0,K.jsx)(bR.Label,{htmlFor:"image_url",children:"Image URL"}),(0,K.jsx)(bQ.Input,{id:"image_url",name:"image_url",type:"url",defaultValue:a?.image_url||"",placeholder:"/placeholder.svg?height=400&width=600"})]}),(0,K.jsxs)("div",{className:"space-y-2",children:[(0,K.jsx)(bR.Label,{htmlFor:"tags",children:"Tags (comma-separated) *"}),(0,K.jsx)(bQ.Input,{id:"tags",name:"tags",defaultValue:a?.tags.join(", "),placeholder:"React, Next.js, TypeScript",required:!0})]}),(0,K.jsxs)("div",{className:"space-y-2",children:[(0,K.jsx)(bR.Label,{htmlFor:"project_url",children:"Project URL"}),(0,K.jsx)(bQ.Input,{id:"project_url",name:"project_url",type:"url",defaultValue:a?.project_url||"",placeholder:"https://example.com"})]}),(0,K.jsxs)("div",{className:"space-y-2",children:[(0,K.jsx)(bR.Label,{htmlFor:"github_url",children:"GitHub URL"}),(0,K.jsx)(bQ.Input,{id:"github_url",name:"github_url",type:"url",defaultValue:a?.github_url||"",placeholder:"https://github.com/username/repo"})]}),e&&(0,K.jsx)("p",{className:"text-sm text-destructive",children:e}),(0,K.jsx)(M.Button,{type:"submit",className:"w-full",disabled:c,children:c?"Saving...":a?"Update Project":"Create Project"})]})}function bY({open:a,onOpenChange:b,project:c,onSuccess:d}){return(0,K.jsx)(bJ,{open:a,onOpenChange:b,children:(0,K.jsxs)(bM,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,K.jsxs)(bN,{children:[(0,K.jsx)(bO,{children:c?"Edit Project":"Add New Project"}),(0,K.jsx)(bP,{children:c?"Update the project details below.":"Fill in the details to create a new project."})]}),(0,K.jsx)(bX,{project:c,onSuccess:()=>{b(!1),d?.()}})]})})}var bZ="AlertDialog",[b$,b_]=Z(bZ,[bd]),b0=bd(),b1=a=>{let{__scopeAlertDialog:b,...c}=a,d=b0(b);return(0,K.jsx)(bg,{...d,...c,modal:!0})};b1.displayName=bZ,L.forwardRef((a,b)=>{let{__scopeAlertDialog:c,...d}=a,e=b0(c);return(0,K.jsx)(bi,{...e,...d,ref:b})}).displayName="AlertDialogTrigger";var b2=a=>{let{__scopeAlertDialog:b,...c}=a,d=b0(b);return(0,K.jsx)(bm,{...d,...c})};b2.displayName="AlertDialogPortal";var b3=L.forwardRef((a,b)=>{let{__scopeAlertDialog:c,...d}=a,e=b0(c);return(0,K.jsx)(bo,{...e,...d,ref:b})});b3.displayName="AlertDialogOverlay";var b4="AlertDialogContent",[b5,b6]=b$(b4),b7=L.forwardRef((a,b)=>{let{__scopeAlertDialog:c,children:d,...e}=a,f=b0(c),g=L.useRef(null),h=(0,Y.useComposedRefs)(b,g),i=L.useRef(null);return(0,K.jsx)(bD,{contentName:b4,titleName:b8,docsSlug:"alert-dialog",children:(0,K.jsx)(b5,{scope:c,cancelRef:i,children:(0,K.jsxs)(br,{role:"alertdialog",...f,...e,ref:h,onOpenAutoFocus:X(e.onOpenAutoFocus,a=>{a.preventDefault(),i.current?.focus({preventScroll:!0})}),onPointerDownOutside:a=>a.preventDefault(),onInteractOutside:a=>a.preventDefault(),children:[(0,K.jsx)(ba.Slottable,{children:d}),(0,K.jsx)(cf,{contentRef:g})]})})})});b7.displayName=b4;var b8="AlertDialogTitle",b9=L.forwardRef((a,b)=>{let{__scopeAlertDialog:c,...d}=a,e=b0(c);return(0,K.jsx)(bw,{...e,...d,ref:b})});b9.displayName=b8;var ca="AlertDialogDescription",cb=L.forwardRef((a,b)=>{let{__scopeAlertDialog:c,...d}=a,e=b0(c);return(0,K.jsx)(by,{...e,...d,ref:b})});cb.displayName=ca;var cc=L.forwardRef((a,b)=>{let{__scopeAlertDialog:c,...d}=a,e=b0(c);return(0,K.jsx)(bA,{...e,...d,ref:b})});cc.displayName="AlertDialogAction";var cd="AlertDialogCancel",ce=L.forwardRef((a,b)=>{let{__scopeAlertDialog:c,...d}=a,{cancelRef:e}=b6(cd,c),f=b0(c),g=(0,Y.useComposedRefs)(b,e);return(0,K.jsx)(bA,{...f,...d,ref:g})});ce.displayName=cd;var cf=({contentRef:a})=>{let b=`\`${b4}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${b4}\` by passing a \`${ca}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${b4}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return L.useEffect(()=>{document.getElementById(a.current?.getAttribute("aria-describedby"))||console.warn(b)},[b,a]),null};function cg({...a}){return(0,K.jsx)(b1,{"data-slot":"alert-dialog",...a})}function ch({...a}){return(0,K.jsx)(b2,{"data-slot":"alert-dialog-portal",...a})}function ci({className:a,...b}){return(0,K.jsx)(b3,{"data-slot":"alert-dialog-overlay",className:(0,bI.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...b})}function cj({className:a,...b}){return(0,K.jsxs)(ch,{children:[(0,K.jsx)(ci,{}),(0,K.jsx)(b7,{"data-slot":"alert-dialog-content",className:(0,bI.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...b})]})}function ck({className:a,...b}){return(0,K.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,bI.cn)("flex flex-col gap-2 text-center sm:text-left",a),...b})}function cl({className:a,...b}){return(0,K.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,bI.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...b})}function cm({className:a,...b}){return(0,K.jsx)(b9,{"data-slot":"alert-dialog-title",className:(0,bI.cn)("text-lg font-semibold",a),...b})}function cn({className:a,...b}){return(0,K.jsx)(cb,{"data-slot":"alert-dialog-description",className:(0,bI.cn)("text-muted-foreground text-sm",a),...b})}function co({className:a,...b}){return(0,K.jsx)(cc,{className:(0,bI.cn)((0,M.buttonVariants)(),a),...b})}function cp({className:a,...b}){return(0,K.jsx)(ce,{className:(0,bI.cn)((0,M.buttonVariants)({variant:"outline"}),a),...b})}var cq=(0,bT.createServerReference)("40f4a1912753ad07a8618ac4beb0ef0d0465218754",bT.callServer,void 0,bT.findSourceMapURL,"deleteProject");function cr({open:a,onOpenChange:b,projectId:c,projectTitle:d,onDeleted:e}){let[f,g]=(0,L.useState)(!1),h=async()=>{g(!0),(await cq(c)).success&&(e?.(c),b(!1)),g(!1)};return(0,K.jsx)(cg,{open:a,onOpenChange:b,children:(0,K.jsxs)(cj,{children:[(0,K.jsxs)(ck,{children:[(0,K.jsx)(cm,{children:"Are you sure?"}),(0,K.jsxs)(cn,{children:['This will permanently delete the project "',d,'". This action cannot be undone.']})]}),(0,K.jsxs)(cl,{children:[(0,K.jsx)(cp,{disabled:f,children:"Cancel"}),(0,K.jsxs)(co,{onClick:h,disabled:f,className:"bg-destructive text-white hover:bg-destructive/90",children:[(0,K.jsx)(V,{className:"h-4 w-4 mr-2"}),f?"Deleting...":"Delete"]})]})]})})}function cs({project:a,onDeleted:b,onUpdated:c}){let[d,e]=(0,L.useState)(!1),[f,g]=(0,L.useState)(!1);return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)(S.Card,{className:"overflow-hidden flex flex-col h-full",children:[a.image_url&&(0,K.jsx)("div",{className:"relative w-full h-48 bg-muted",children:(0,K.jsx)(W.default,{src:a.image_url||"/placeholder.svg",alt:a.title,fill:!0,className:"object-cover"})}),(0,K.jsxs)(S.CardHeader,{children:[(0,K.jsx)(S.CardTitle,{className:"text-balance",children:a.title}),(0,K.jsx)(S.CardDescription,{className:"text-pretty line-clamp-2",children:a.description})]}),(0,K.jsx)(S.CardContent,{className:"flex-1",children:(0,K.jsx)("div",{className:"flex flex-wrap gap-2",children:a.tags.map(a=>(0,K.jsx)(T.Badge,{variant:"secondary",children:a},a))})}),(0,K.jsxs)(S.CardFooter,{className:"flex gap-2",children:[(0,K.jsxs)(M.Button,{variant:"outline",size:"sm",onClick:()=>e(!0),className:"flex-1",children:[(0,K.jsx)(U,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,K.jsxs)(M.Button,{variant:"destructive",size:"sm",onClick:()=>g(!0),className:"flex-1",children:[(0,K.jsx)(V,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]}),(0,K.jsx)(bY,{open:d,onOpenChange:e,project:a,onSuccess:c}),(0,K.jsx)(cr,{open:f,onOpenChange:g,projectId:a.id,projectTitle:a.title,onDeleted:b})]})}let ct=(0,N.default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var cu=(0,bT.createServerReference)("4091921f9b99646f6d459821464ad48967905d55e8",bT.callServer,void 0,bT.findSourceMapURL,"createAdmin");function cv({onSuccess:a}){let[b,c]=(0,L.useState)(!1),[d,e]=(0,L.useState)(null);async function f(b){b.preventDefault(),c(!0),e(null);let d=new FormData(b.currentTarget),f=await cu(d);f.success?(a?.(),b.target.reset()):e(f.error||"Failed to create admin"),c(!1)}return(0,K.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,K.jsxs)("div",{className:"space-y-2",children:[(0,K.jsx)(bR.Label,{htmlFor:"email",children:"Email"}),(0,K.jsx)(bQ.Input,{id:"email",name:"email",type:"email",placeholder:"admin@example.com",required:!0})]}),(0,K.jsxs)("div",{className:"space-y-2",children:[(0,K.jsx)(bR.Label,{htmlFor:"password",children:"Password"}),(0,K.jsx)(bQ.Input,{id:"password",name:"password",type:"password",placeholder:"Enter password",required:!0})]}),d&&(0,K.jsx)("p",{className:"text-sm text-destructive",children:d}),(0,K.jsxs)(M.Button,{type:"submit",disabled:b,className:"w-full",children:[b&&(0,K.jsx)(ct,{className:"mr-2 h-4 w-4 animate-spin"}),"Add Admin"]})]})}function cw({open:a,onOpenChange:b,onSuccess:c}){return(0,K.jsx)(bJ,{open:a,onOpenChange:b,children:(0,K.jsxs)(bM,{children:[(0,K.jsxs)(bN,{children:[(0,K.jsx)(bO,{children:"Add New Admin"}),(0,K.jsx)(bP,{children:"Create a new admin account with email and password."})]}),(0,K.jsx)(cv,{onSuccess:()=>{c?.(),b(!1)}})]})})}let cx=(0,N.default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);var cy=(0,bT.createServerReference)("40c58ac037c23df836e14400331c8871a9e9174332",bT.callServer,void 0,bT.findSourceMapURL,"deleteAdmin");function cz({open:a,onOpenChange:b,adminId:c,adminEmail:d,onDeleted:e}){let[f,g]=(0,L.useState)(!1);async function h(){g(!0),(await cy(c)).success&&(e?.(),b(!1)),g(!1)}return(0,K.jsx)(cg,{open:a,onOpenChange:b,children:(0,K.jsxs)(cj,{children:[(0,K.jsxs)(ck,{children:[(0,K.jsx)(cm,{children:"Are you sure?"}),(0,K.jsxs)(cn,{children:["This will permanently delete the admin account for ",(0,K.jsx)("strong",{children:d}),". This action cannot be undone."]})]}),(0,K.jsxs)(cl,{children:[(0,K.jsx)(cp,{disabled:f,children:"Cancel"}),(0,K.jsx)(co,{onClick:h,disabled:f,className:"bg-destructive text-white hover:bg-destructive/90",children:f?(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(ct,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(V,{className:"mr-2 h-4 w-4"}),"Delete"]})})]})]})})}function cA({admin:a,onDeleted:b}){let[c,d]=(0,L.useState)(!1);return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)(S.Card,{children:[(0,K.jsx)(S.CardContent,{className:"pt-6",children:(0,K.jsxs)("div",{className:"flex items-start gap-3",children:[(0,K.jsx)("div",{className:"rounded-full bg-primary/10 p-2",children:(0,K.jsx)(cx,{className:"h-5 w-5 text-primary"})}),(0,K.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,K.jsx)("p",{className:"font-medium truncate",children:a.email}),(0,K.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Added ",new Date(a.created_at).toLocaleDateString()]})]})]})}),(0,K.jsx)(S.CardFooter,{children:(0,K.jsxs)(M.Button,{variant:"destructive",size:"sm",onClick:()=>d(!0),className:"w-full",children:[(0,K.jsx)(V,{className:"mr-2 h-4 w-4"}),"Remove Admin"]})})]}),(0,K.jsx)(cz,{open:c,onOpenChange:d,adminId:a.id,adminEmail:a.email,onDeleted:b})]})}var cB=a.i(10893),cC="horizontal",cD=["horizontal","vertical"],cE=L.forwardRef((a,b)=>{var c;let{decorative:d,orientation:e=cC,...f}=a,g=(c=e,cD.includes(c))?e:cC;return(0,K.jsx)(ad.Primitive.div,{"data-orientation":g,...d?{role:"none"}:{"aria-orientation":"vertical"===g?g:void 0,role:"separator"},...f,ref:b})});function cF({className:a,orientation:b="horizontal",decorative:c=!0,...d}){return(0,K.jsx)(cE,{"data-slot":"separator",decorative:c,orientation:b,className:(0,bI.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",a),...d})}cE.displayName="Separator";var cG=(0,bT.createServerReference)("00f239c33ba855bae1176710cef746cc2e85e1879e",bT.callServer,void 0,bT.findSourceMapURL,"logoutAdmin"),cH=(0,bT.createServerReference)("004d81a2a0dc611841a0c181542c6af9e55277024c",bT.callServer,void 0,bT.findSourceMapURL,"getAdmins");class cI extends Error{constructor(a,b="FunctionsError",c){super(a),this.name=b,this.context=c}}class cJ extends cI{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class cK extends cI{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class cL extends cI{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}(n=z||(z={})).Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2";class cM{constructor(a,{headers:b={},customFetch:c,region:d=z.Any}={}){this.url=a,this.headers=b,this.region=d,this.fetch=(a=>a?(...b)=>a(...b):(...a)=>fetch(...a))(c)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a){var b,c,d,e;return b=this,c=arguments,d=void 0,e=function*(a,b={}){var c;let d,e;try{let f,{headers:g,method:h,body:i,signal:j,timeout:k}=b,l={},{region:m}=b;m||(m=this.region);let n=new URL(`${this.url}/${a}`);m&&"any"!==m&&(l["x-region"]=m,n.searchParams.set("forceFunctionRegion",m)),i&&(g&&!Object.prototype.hasOwnProperty.call(g,"Content-Type")||!g)?"undefined"!=typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",f=i):"string"==typeof i?(l["Content-Type"]="text/plain",f=i):"undefined"!=typeof FormData&&i instanceof FormData?f=i:(l["Content-Type"]="application/json",f=JSON.stringify(i)):f=i;let o=j;k&&(e=new AbortController,d=setTimeout(()=>e.abort(),k),j?(o=e.signal,j.addEventListener("abort",()=>e.abort())):o=e.signal);let p=yield this.fetch(n.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),g),body:f,signal:o}).catch(a=>{throw new cJ(a)}),q=p.headers.get("x-relay-error");if(q&&"true"===q)throw new cK(p);if(!p.ok)throw new cL(p);let r=(null!=(c=p.headers.get("Content-Type"))?c:"text/plain").split(";")[0].trim();return{data:"application/json"===r?yield p.json():"application/octet-stream"===r||"application/pdf"===r?yield p.blob():"text/event-stream"===r?p:"multipart/form-data"===r?yield p.formData():yield p.text(),error:null,response:p}}catch(a){return{data:null,error:a,response:a instanceof cL||a instanceof cK?a.context:void 0}}finally{d&&clearTimeout(d)}},new(d||(d=Promise))(function(a,f){function g(a){try{i(e.next(a))}catch(a){f(a)}}function h(a){try{i(e.throw(a))}catch(a){f(a)}}function i(b){var c;b.done?a(b.value):((c=b.value)instanceof d?c:new d(function(a){a(c)})).then(g,h)}i((e=e.apply(b,c||[])).next())})}}var cN=class extends Error{constructor(a){super(a.message),this.name="PostgrestError",this.details=a.details,this.hint=a.hint,this.code=a.code}},cO=class{constructor(a){var b,c;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=null!=(b=a.shouldThrowOnError)&&b,this.signal=a.signal,this.isMaybeSingle=null!=(c=a.isMaybeSingle)&&c,a.fetch?this.fetch=a.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,b){return this.headers=new Headers(this.headers),this.headers.set(a,b),this}then(a,b){var c=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let d=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var b,d,e,f;let g=null,h=null,i=null,j=a.status,k=a.statusText;if(a.ok){if("HEAD"!==c.method){let b=await a.text();""===b||(h="text/csv"===c.headers.get("Accept")||c.headers.get("Accept")&&(null==(e=c.headers.get("Accept"))?void 0:e.includes("application/vnd.pgrst.plan+text"))?b:JSON.parse(b))}let f=null==(b=c.headers.get("Prefer"))?void 0:b.match(/count=(exact|planned|estimated)/),l=null==(d=a.headers.get("content-range"))?void 0:d.split("/");f&&l&&l.length>1&&(i=parseInt(l[1])),c.isMaybeSingle&&"GET"===c.method&&Array.isArray(h)&&(h.length>1?(g={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,i=null,j=406,k="Not Acceptable"):h=1===h.length?h[0]:null)}else{let b=await a.text();try{g=JSON.parse(b),Array.isArray(g)&&404===a.status&&(h=[],g=null,j=200,k="OK")}catch(c){404===a.status&&""===b?(j=204,k="No Content"):g={message:b}}if(g&&c.isMaybeSingle&&(null==g||null==(f=g.details)?void 0:f.includes("0 rows"))&&(g=null,j=200,k="OK"),g&&c.shouldThrowOnError)throw new cN(g)}return{error:g,data:h,count:i,status:j,statusText:k}});return this.shouldThrowOnError||(d=d.catch(a=>{var b,c,d,e,f,g;let h="",i=null==a?void 0:a.cause;if(i){let b=null!=(c=null==i?void 0:i.message)?c:"",g=null!=(d=null==i?void 0:i.code)?d:"";h=`${null!=(e=null==a?void 0:a.name)?e:"FetchError"}: ${null==a?void 0:a.message}

Caused by: ${null!=(f=null==i?void 0:i.name)?f:"Error"}: ${b}`,g&&(h+=` (${g})`),(null==i?void 0:i.stack)&&(h+=`
${i.stack}`)}else h=null!=(g=null==a?void 0:a.stack)?g:"";return{error:{message:`${null!=(b=null==a?void 0:a.name)?b:"FetchError"}: ${null==a?void 0:a.message}`,details:h,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),d.then(a,b)}returns(){return this}overrideTypes(){return this}},cP=class extends cO{select(a){let b=!1,c=(null!=a?a:"*").split("").map(a=>/\s/.test(a)&&!b?"":('"'===a&&(b=!b),a)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:b=!0,nullsFirst:c,foreignTable:d,referencedTable:e=d}={}){let f=e?`${e}.order`:"order",g=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${g?`${g},`:""}${a}.${b?"asc":"desc"}${void 0===c?"":c?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:b,referencedTable:c=b}={}){let d=void 0===c?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this}range(a,b,{foreignTable:c,referencedTable:d=c}={}){let e=void 0===d?"offset":`${d}.offset`,f=void 0===d?"limit":`${d}.limit`;return this.url.searchParams.set(e,`${a}`),this.url.searchParams.set(f,`${b-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:b=!1,settings:c=!1,buffers:d=!1,wal:e=!1,format:f="text"}={}){var g;let h=[a?"analyze":null,b?"verbose":null,c?"settings":null,d?"buffers":null,e?"wal":null].filter(Boolean).join("|"),i=null!=(g=this.headers.get("Accept"))?g:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${f}; for="${i}"; options=${h};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}};let cQ=RegExp("[,()]");var cR=class extends cP{eq(a,b){return this.url.searchParams.append(a,`eq.${b}`),this}neq(a,b){return this.url.searchParams.append(a,`neq.${b}`),this}gt(a,b){return this.url.searchParams.append(a,`gt.${b}`),this}gte(a,b){return this.url.searchParams.append(a,`gte.${b}`),this}lt(a,b){return this.url.searchParams.append(a,`lt.${b}`),this}lte(a,b){return this.url.searchParams.append(a,`lte.${b}`),this}like(a,b){return this.url.searchParams.append(a,`like.${b}`),this}likeAllOf(a,b){return this.url.searchParams.append(a,`like(all).{${b.join(",")}}`),this}likeAnyOf(a,b){return this.url.searchParams.append(a,`like(any).{${b.join(",")}}`),this}ilike(a,b){return this.url.searchParams.append(a,`ilike.${b}`),this}ilikeAllOf(a,b){return this.url.searchParams.append(a,`ilike(all).{${b.join(",")}}`),this}ilikeAnyOf(a,b){return this.url.searchParams.append(a,`ilike(any).{${b.join(",")}}`),this}regexMatch(a,b){return this.url.searchParams.append(a,`match.${b}`),this}regexIMatch(a,b){return this.url.searchParams.append(a,`imatch.${b}`),this}is(a,b){return this.url.searchParams.append(a,`is.${b}`),this}isDistinct(a,b){return this.url.searchParams.append(a,`isdistinct.${b}`),this}in(a,b){let c=Array.from(new Set(b)).map(a=>"string"==typeof a&&cQ.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(a,`in.(${c})`),this}notIn(a,b){let c=Array.from(new Set(b)).map(a=>"string"==typeof a&&cQ.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(a,`not.in.(${c})`),this}contains(a,b){return"string"==typeof b?this.url.searchParams.append(a,`cs.${b}`):Array.isArray(b)?this.url.searchParams.append(a,`cs.{${b.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(b)}`),this}containedBy(a,b){return"string"==typeof b?this.url.searchParams.append(a,`cd.${b}`):Array.isArray(b)?this.url.searchParams.append(a,`cd.{${b.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(b)}`),this}rangeGt(a,b){return this.url.searchParams.append(a,`sr.${b}`),this}rangeGte(a,b){return this.url.searchParams.append(a,`nxl.${b}`),this}rangeLt(a,b){return this.url.searchParams.append(a,`sl.${b}`),this}rangeLte(a,b){return this.url.searchParams.append(a,`nxr.${b}`),this}rangeAdjacent(a,b){return this.url.searchParams.append(a,`adj.${b}`),this}overlaps(a,b){return"string"==typeof b?this.url.searchParams.append(a,`ov.${b}`):this.url.searchParams.append(a,`ov.{${b.join(",")}}`),this}textSearch(a,b,{config:c,type:d}={}){let e="";"plain"===d?e="pl":"phrase"===d?e="ph":"websearch"===d&&(e="w");let f=void 0===c?"":`(${c})`;return this.url.searchParams.append(a,`${e}fts${f}.${b}`),this}match(a){return Object.entries(a).forEach(([a,b])=>{this.url.searchParams.append(a,`eq.${b}`)}),this}not(a,b,c){return this.url.searchParams.append(a,`not.${b}.${c}`),this}or(a,{foreignTable:b,referencedTable:c=b}={}){let d=c?`${c}.or`:"or";return this.url.searchParams.append(d,`(${a})`),this}filter(a,b,c){return this.url.searchParams.append(a,`${b}.${c}`),this}},cS=class{constructor(a,{headers:b={},schema:c,fetch:d}){this.url=a,this.headers=new Headers(b),this.schema=c,this.fetch=d}select(a,b){let{head:c=!1,count:d}=null!=b?b:{},e=!1,f=(null!=a?a:"*").split("").map(a=>/\s/.test(a)&&!e?"":('"'===a&&(e=!e),a)).join("");return this.url.searchParams.set("select",f),d&&this.headers.append("Prefer",`count=${d}`),new cR({method:c?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:b,defaultToNull:c=!0}={}){var d;if(b&&this.headers.append("Prefer",`count=${b}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){let b=a.reduce((a,b)=>a.concat(Object.keys(b)),[]);if(b.length>0){let a=[...new Set(b)].map(a=>`"${a}"`);this.url.searchParams.set("columns",a.join(","))}}return new cR({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:null!=(d=this.fetch)?d:fetch})}upsert(a,{onConflict:b,ignoreDuplicates:c=!1,count:d,defaultToNull:e=!0}={}){var f;if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),void 0!==b&&this.url.searchParams.set("on_conflict",b),d&&this.headers.append("Prefer",`count=${d}`),e||this.headers.append("Prefer","missing=default"),Array.isArray(a)){let b=a.reduce((a,b)=>a.concat(Object.keys(b)),[]);if(b.length>0){let a=[...new Set(b)].map(a=>`"${a}"`);this.url.searchParams.set("columns",a.join(","))}}return new cR({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:null!=(f=this.fetch)?f:fetch})}update(a,{count:b}={}){var c;return b&&this.headers.append("Prefer",`count=${b}`),new cR({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:null!=(c=this.fetch)?c:fetch})}delete({count:a}={}){var b;return a&&this.headers.append("Prefer",`count=${a}`),new cR({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!=(b=this.fetch)?b:fetch})}},cT=class a{constructor(a,{headers:b={},schema:c,fetch:d}={}){this.url=a,this.headers=new Headers(b),this.schemaName=c,this.fetch=d}from(a){if(!a||"string"!=typeof a||""===a.trim())throw Error("Invalid relation name: relation must be a non-empty string.");return new cS(new URL(`${this.url}/${a}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(b){return new a(this.url,{headers:this.headers,schema:b,fetch:this.fetch})}rpc(a,b={},{head:c=!1,get:d=!1,count:e}={}){var f;let g,h,i=new URL(`${this.url}/rpc/${a}`);c||d?(g=c?"HEAD":"GET",Object.entries(b).filter(([a,b])=>void 0!==b).map(([a,b])=>[a,Array.isArray(b)?`{${b.join(",")}}`:`${b}`]).forEach(([a,b])=>{i.searchParams.append(a,b)})):(g="POST",h=b);let j=new Headers(this.headers);return e&&j.set("Prefer",`count=${e}`),new cR({method:g,url:i,headers:j,schema:this.schemaName,body:h,fetch:null!=(f=this.fetch)?f:fetch})}};let cU=class{constructor(){}static detectEnvironment(){var b;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if(void 0!==a.g.WebSocket)return{type:"native",constructor:a.g.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null==(b=navigator.userAgent)?void 0:b.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!=typeof process){let a=process.versions;if(a&&a.node){let b=parseInt(a.node.replace(/^v/,"").split(".")[0]);return b>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${b} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${b} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){let a=this.detectEnvironment();if(a.constructor)return a.constructor;let b=a.error||"WebSocket not supported in this environment.";throw a.workaround&&(b+=`

Suggested solution: ${a.workaround}`),Error(b)}static createWebSocket(a,b){return new(this.getWebSocketConstructor())(a,b)}static isWebSocketSupported(){try{let a=this.detectEnvironment();return"native"===a.type||"ws"===a.type}catch(a){return!1}}},cV="1.0.0";(o=A||(A={}))[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed",(p=B||(B={})).closed="closed",p.errored="errored",p.joined="joined",p.joining="joining",p.leaving="leaving",(q=C||(C={})).close="phx_close",q.error="phx_error",q.join="phx_join",q.reply="phx_reply",q.leave="phx_leave",q.access_token="access_token",(D||(D={})).websocket="websocket",(r=E||(E={})).Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed";class cW{constructor(a){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=null!=a?a:[]}encode(a,b){return a.event!==this.BROADCAST_EVENT||a.payload instanceof ArrayBuffer||"string"!=typeof a.payload.event?b(JSON.stringify([a.join_ref,a.ref,a.topic,a.event,a.payload])):b(this._binaryEncodeUserBroadcastPush(a))}_binaryEncodeUserBroadcastPush(a){var b;return this._isArrayBuffer(null==(b=a.payload)?void 0:b.payload)?this._encodeBinaryUserBroadcastPush(a):this._encodeJsonUserBroadcastPush(a)}_encodeBinaryUserBroadcastPush(a){var b,c;let d=null!=(c=null==(b=a.payload)?void 0:b.payload)?c:new ArrayBuffer(0);return this._encodeUserBroadcastPush(a,this.BINARY_ENCODING,d)}_encodeJsonUserBroadcastPush(a){var b,c;let d=null!=(c=null==(b=a.payload)?void 0:b.payload)?c:{},e=new TextEncoder().encode(JSON.stringify(d)).buffer;return this._encodeUserBroadcastPush(a,this.JSON_ENCODING,e)}_encodeUserBroadcastPush(a,b,c){let d=a.topic,e=null!=(n=a.ref)?n:"",f=null!=(o=a.join_ref)?o:"",g=a.payload.event,h=this.allowedMetadataKeys?this._pick(a.payload,this.allowedMetadataKeys):{},i=0===Object.keys(h).length?"":JSON.stringify(h);if(f.length>255)throw Error(`joinRef length ${f.length} exceeds maximum of 255`);if(e.length>255)throw Error(`ref length ${e.length} exceeds maximum of 255`);if(d.length>255)throw Error(`topic length ${d.length} exceeds maximum of 255`);if(g.length>255)throw Error(`userEvent length ${g.length} exceeds maximum of 255`);if(i.length>255)throw Error(`metadata length ${i.length} exceeds maximum of 255`);let j=this.USER_BROADCAST_PUSH_META_LENGTH+f.length+e.length+d.length+g.length+i.length,k=new ArrayBuffer(this.HEADER_LENGTH+j),l=new DataView(k),m=0;l.setUint8(m++,this.KINDS.userBroadcastPush),l.setUint8(m++,f.length),l.setUint8(m++,e.length),l.setUint8(m++,d.length),l.setUint8(m++,g.length),l.setUint8(m++,i.length),l.setUint8(m++,b),Array.from(f,a=>l.setUint8(m++,a.charCodeAt(0))),Array.from(e,a=>l.setUint8(m++,a.charCodeAt(0))),Array.from(d,a=>l.setUint8(m++,a.charCodeAt(0))),Array.from(g,a=>l.setUint8(m++,a.charCodeAt(0))),Array.from(i,a=>l.setUint8(m++,a.charCodeAt(0)));var n,o,p=new Uint8Array(k.byteLength+c.byteLength);return p.set(new Uint8Array(k),0),p.set(new Uint8Array(c),k.byteLength),p.buffer}decode(a,b){if(this._isArrayBuffer(a))return b(this._binaryDecode(a));if("string"==typeof a){let[c,d,e,f,g]=JSON.parse(a);return b({join_ref:c,ref:d,topic:e,event:f,payload:g})}return b({})}_binaryDecode(a){let b=new DataView(a),c=b.getUint8(0),d=new TextDecoder;if(c===this.KINDS.userBroadcast)return this._decodeUserBroadcast(a,b,d)}_decodeUserBroadcast(a,b,c){let d=b.getUint8(1),e=b.getUint8(2),f=b.getUint8(3),g=b.getUint8(4),h=this.HEADER_LENGTH+4,i=c.decode(a.slice(h,h+d));h+=d;let j=c.decode(a.slice(h,h+e));h+=e;let k=c.decode(a.slice(h,h+f));h+=f;let l=a.slice(h,a.byteLength),m=g===this.JSON_ENCODING?JSON.parse(c.decode(l)):l,n={type:this.BROADCAST_EVENT,event:j,payload:m};return f>0&&(n.meta=JSON.parse(k)),{join_ref:null,ref:null,topic:i,event:this.BROADCAST_EVENT,payload:n}}_isArrayBuffer(a){var b;return a instanceof ArrayBuffer||(null==(b=null==a?void 0:a.constructor)?void 0:b.name)==="ArrayBuffer"}_pick(a,b){return a&&"object"==typeof a?Object.fromEntries(Object.entries(a).filter(([a])=>b.includes(a))):{}}}class cX{constructor(a,b){this.callback=a,this.timerCalc=b,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=b}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(s=F||(F={})).abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange";let cY=(a,b,c={})=>{var d;let e=null!=(d=c.skipTypes)?d:[];return b?Object.keys(b).reduce((c,d)=>(c[d]=cZ(d,a,b,e),c),{}):{}},cZ=(a,b,c,d)=>{let e=b.find(b=>b.name===a),f=null==e?void 0:e.type,g=c[a];return f&&!d.includes(f)?c$(f,g):c_(g)},c$=(a,b)=>{if("_"===a.charAt(0))return c3(b,a.slice(1,a.length));switch(a){case F.bool:return c0(b);case F.float4:case F.float8:case F.int2:case F.int4:case F.int8:case F.numeric:case F.oid:return c1(b);case F.json:case F.jsonb:return c2(b);case F.timestamp:return c4(b);case F.abstime:case F.date:case F.daterange:case F.int4range:case F.int8range:case F.money:case F.reltime:case F.text:case F.time:case F.timestamptz:case F.timetz:case F.tsrange:case F.tstzrange:default:return c_(b)}},c_=a=>a,c0=a=>{switch(a){case"t":return!0;case"f":return!1;default:return a}},c1=a=>{if("string"==typeof a){let b=parseFloat(a);if(!Number.isNaN(b))return b}return a},c2=a=>{if("string"==typeof a)try{return JSON.parse(a)}catch(a){}return a},c3=(a,b)=>{if("string"!=typeof a)return a;let c=a.length-1,d=a[c];if("{"===a[0]&&"}"===d){let d,e=a.slice(1,c);try{d=JSON.parse("["+e+"]")}catch(a){d=e?e.split(","):[]}return d.map(a=>c$(b,a))}return a},c4=a=>"string"==typeof a?a.replace(" ","T"):a,c5=a=>{let b=new URL(a);return b.protocol=b.protocol.replace(/^ws/i,"http"),b.pathname=b.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===b.pathname||"/"===b.pathname?b.pathname="/api/broadcast":b.pathname=b.pathname+"/api/broadcast",b.href};class c6{constructor(a,b,c={},d=1e4){this.channel=a,this.event=b,this.payload=c,this.timeout=d,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,b){var c;return this._hasReceived(a)&&b(null==(c=this.receivedResp)?void 0:c.response),this.recHooks.push({status:a,callback:b}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let a=a=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=a,this._matchReceive(a)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,b){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:b})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:b}){this.recHooks.filter(b=>b.status===a).forEach(a=>a.callback(b))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}(t=G||(G={})).SYNC="sync",t.JOIN="join",t.LEAVE="leave";class c7{constructor(a,b){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const c=(null==b?void 0:b.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(c.state,{},a=>{let{onJoin:b,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=c7.syncState(this.state,a,b,c),this.pendingDiffs.forEach(a=>{this.state=c7.syncDiff(this.state,a,b,c)}),this.pendingDiffs=[],d()}),this.channel._on(c.diff,{},a=>{let{onJoin:b,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=c7.syncDiff(this.state,a,b,c),d())}),this.onJoin((a,b,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:b,newPresences:c})}),this.onLeave((a,b,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:b,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,b,c,d){let e=this.cloneDeep(a),f=this.transformState(b),g={},h={};return this.map(e,(a,b)=>{f[a]||(h[a]=b)}),this.map(f,(a,b)=>{let c=e[a];if(c){let d=b.map(a=>a.presence_ref),e=c.map(a=>a.presence_ref),f=b.filter(a=>0>e.indexOf(a.presence_ref)),i=c.filter(a=>0>d.indexOf(a.presence_ref));f.length>0&&(g[a]=f),i.length>0&&(h[a]=i)}else g[a]=b}),this.syncDiff(e,{joins:g,leaves:h},c,d)}static syncDiff(a,b,c,d){let{joins:e,leaves:f}={joins:this.transformState(b.joins),leaves:this.transformState(b.leaves)};return c||(c=()=>{}),d||(d=()=>{}),this.map(e,(b,d)=>{var e;let f=null!=(e=a[b])?e:[];if(a[b]=this.cloneDeep(d),f.length>0){let c=a[b].map(a=>a.presence_ref),d=f.filter(a=>0>c.indexOf(a.presence_ref));a[b].unshift(...d)}c(b,f,d)}),this.map(f,(b,c)=>{let e=a[b];if(!e)return;let f=c.map(a=>a.presence_ref);e=e.filter(a=>0>f.indexOf(a.presence_ref)),a[b]=e,d(b,e,c),0===e.length&&delete a[b]}),a}static map(a,b){return Object.getOwnPropertyNames(a).map(c=>b(c,a[c]))}static transformState(a){return Object.getOwnPropertyNames(a=this.cloneDeep(a)).reduce((b,c)=>{let d=a[c];return"metas"in d?b[c]=d.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):b[c]=d,b},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(u=H||(H={})).ALL="*",u.INSERT="INSERT",u.UPDATE="UPDATE",u.DELETE="DELETE",(v=I||(I={})).BROADCAST="broadcast",v.PRESENCE="presence",v.POSTGRES_CHANGES="postgres_changes",v.SYSTEM="system",(w=J||(J={})).SUBSCRIBED="SUBSCRIBED",w.TIMED_OUT="TIMED_OUT",w.CLOSED="CLOSED",w.CHANNEL_ERROR="CHANNEL_ERROR";class c8{constructor(a,b={config:{}},c){var d,e;if(this.topic=a,this.params=b,this.socket=c,this.bindings={},this.state=B.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},b.config),this.timeout=this.socket.timeout,this.joinPush=new c6(this,C.join,this.params,this.timeout),this.rejoinTimer=new cX(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=B.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=B.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=B.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=B.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=B.errored,this.rejoinTimer.scheduleTimeout())}),this._on(C.reply,{},(a,b)=>{this._trigger(this._replyEventName(b),a)}),this.presence=new c7(this),this.broadcastEndpointURL=c5(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null==(e=null==(d=this.params.config)?void 0:d.broadcast)?void 0:e.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(a,b=this.timeout){var c,d,e;if(this.socket.isConnected()||this.socket.connect(),this.state==B.closed){let{config:{broadcast:f,presence:g,private:h}}=this.params,i=null!=(d=null==(c=this.bindings.postgres_changes)?void 0:c.map(a=>a.filter))?d:[],j=!!this.bindings[I.PRESENCE]&&this.bindings[I.PRESENCE].length>0||(null==(e=this.params.config.presence)?void 0:e.enabled)===!0,k={},l={broadcast:f,presence:Object.assign(Object.assign({},g),{enabled:j}),postgres_changes:i,private:h};this.socket.accessTokenValue&&(k.access_token=this.socket.accessTokenValue),this._onError(b=>null==a?void 0:a(J.CHANNEL_ERROR,b)),this._onClose(()=>null==a?void 0:a(J.CLOSED)),this.updateJoinPayload(Object.assign({config:l},k)),this.joinedOnce=!0,this._rejoin(b),this.joinPush.receive("ok",async({postgres_changes:b})=>{var c;if(this.socket._isManualToken()||this.socket.setAuth(),void 0===b){null==a||a(J.SUBSCRIBED);return}{let d=this.bindings.postgres_changes,e=null!=(c=null==d?void 0:d.length)?c:0,f=[];for(let c=0;c<e;c++){let e=d[c],{filter:{event:g,schema:h,table:i,filter:j}}=e,k=b&&b[c];if(k&&k.event===g&&c8.isFilterValueEqual(k.schema,h)&&c8.isFilterValueEqual(k.table,i)&&c8.isFilterValueEqual(k.filter,j))f.push(Object.assign(Object.assign({},e),{id:k.id}));else{this.unsubscribe(),this.state=B.errored,null==a||a(J.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=f,a&&a(J.SUBSCRIBED);return}}).receive("error",b=>{this.state=B.errored,null==a||a(J.CHANNEL_ERROR,Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{null==a||a(J.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,b={}){return await this.send({type:"presence",event:"track",payload:a},b.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,b,c){return this.state===B.joined&&a===I.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(a,b,c)}async httpSend(a,b,c={}){var d;if(null==b)return Promise.reject("Payload is required for httpSend()");let e={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(e.Authorization=`Bearer ${this.socket.accessTokenValue}`);let f={method:"POST",headers:e,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:b,private:this.private}]})},g=await this._fetchWithTimeout(this.broadcastEndpointURL,f,null!=(d=c.timeout)?d:this.timeout);if(202===g.status)return{success:!0};let h=g.statusText;try{let a=await g.json();h=a.error||a.message||h}catch(a){}return Promise.reject(Error(h))}async send(a,b={}){var c,d;if(this._canPush()||"broadcast"!==a.type)return new Promise(c=>{var d,e,f;let g=this._push(a.type,a,b.timeout||this.timeout);"broadcast"!==a.type||(null==(f=null==(e=null==(d=this.params)?void 0:d.config)?void 0:e.broadcast)?void 0:f.ack)||c("ok"),g.receive("ok",()=>c("ok")),g.receive("error",()=>c("error")),g.receive("timeout",()=>c("timed out"))});{console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");let{event:e,payload:f}=a,g={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(g.Authorization=`Bearer ${this.socket.accessTokenValue}`);let h={method:"POST",headers:g,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:f,private:this.private}]})};try{let a=await this._fetchWithTimeout(this.broadcastEndpointURL,h,null!=(c=b.timeout)?c:this.timeout);return await (null==(d=a.body)?void 0:d.cancel()),a.ok?"ok":"error"}catch(a){if("AbortError"===a.name)return"timed out";return"error"}}}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=B.leaving;let b=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(C.close,"leave",this._joinRef())};this.joinPush.destroy();let c=null;return new Promise(d=>{(c=new c6(this,C.leave,{},a)).receive("ok",()=>{b(),d("ok")}).receive("timeout",()=>{b(),d("timed out")}).receive("error",()=>{d("error")}),c.send(),this._canPush()||c.trigger("ok",{})}).finally(()=>{null==c||c.destroy()})}teardown(){this.pushBuffer.forEach(a=>a.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=B.closed,this.bindings={}}async _fetchWithTimeout(a,b,c){let d=new AbortController,e=setTimeout(()=>d.abort(),c),f=await this.socket.fetch(a,Object.assign(Object.assign({},b),{signal:d.signal}));return clearTimeout(e),f}_push(a,b,c=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let d=new c6(this,a,b,c);return this._canPush()?d.send():this._addToPushBuffer(d),d}_addToPushBuffer(a){if(a.startTimeout(),this.pushBuffer.push(a),this.pushBuffer.length>100){let a=this.pushBuffer.shift();a&&(a.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${a.event}`,a.payload))}}_onMessage(a,b,c){return b}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,b,c){var d,e;let f=a.toLocaleLowerCase(),{close:g,error:h,leave:i,join:j}=C;if(c&&[g,h,i,j].indexOf(f)>=0&&c!==this._joinRef())return;let k=this._onMessage(f,b,c);if(b&&!k)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?null==(d=this.bindings.postgres_changes)||d.filter(a=>{var b,c,d;return(null==(b=a.filter)?void 0:b.event)==="*"||(null==(d=null==(c=a.filter)?void 0:c.event)?void 0:d.toLocaleLowerCase())===f}).map(a=>a.callback(k,c)):null==(e=this.bindings[f])||e.filter(a=>{var c,d,e,g,h,i;if(!["broadcast","presence","postgres_changes"].includes(f))return a.type.toLocaleLowerCase()===f;if("id"in a){let f=a.id,g=null==(c=a.filter)?void 0:c.event;return f&&(null==(d=b.ids)?void 0:d.includes(f))&&("*"===g||(null==g?void 0:g.toLocaleLowerCase())===(null==(e=b.data)?void 0:e.type.toLocaleLowerCase()))}{let c=null==(h=null==(g=null==a?void 0:a.filter)?void 0:g.event)?void 0:h.toLocaleLowerCase();return"*"===c||c===(null==(i=null==b?void 0:b.event)?void 0:i.toLocaleLowerCase())}}).map(a=>{if("object"==typeof k&&"ids"in k){let a=k.data,{schema:b,table:c,commit_timestamp:d,type:e,errors:f}=a;k=Object.assign(Object.assign({},{schema:b,table:c,commit_timestamp:d,eventType:e,new:{},old:{},errors:f}),this._getPayloadRecords(a))}a.callback(k,c)})}_isClosed(){return this.state===B.closed}_isJoined(){return this.state===B.joined}_isJoining(){return this.state===B.joining}_isLeaving(){return this.state===B.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,b,c){let d=a.toLocaleLowerCase(),e={type:d,filter:b,callback:c};return this.bindings[d]?this.bindings[d].push(e):this.bindings[d]=[e],this}_off(a,b){let c=a.toLocaleLowerCase();return this.bindings[c]&&(this.bindings[c]=this.bindings[c].filter(a=>{var d;return!((null==(d=a.type)?void 0:d.toLocaleLowerCase())===c&&c8.isEqual(a.filter,b))})),this}static isEqual(a,b){if(Object.keys(a).length!==Object.keys(b).length)return!1;for(let c in a)if(a[c]!==b[c])return!1;return!0}static isFilterValueEqual(a,b){return(null!=a?a:void 0)===(null!=b?b:void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(C.close,{},a)}_onError(a){this._on(C.error,{},b=>a(b))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=B.joining,this.joinPush.resend(a))}_getPayloadRecords(a){let b={new:{},old:{}};return("INSERT"===a.type||"UPDATE"===a.type)&&(b.new=cY(a.columns,a.record)),("UPDATE"===a.type||"DELETE"===a.type)&&(b.old=cY(a.columns,a.old_record)),b}}let c9=()=>{},da=[1e3,2e3,5e3,1e4],db=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class dc{constructor(a,b){var c;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.transport=null,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=c9,this.ref=0,this.reconnectTimer=null,this.vsn=cV,this.logger=c9,this.conn=null,this.sendBuffer=[],this.serializer=new cW,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...b)=>a(...b):(...a)=>fetch(...a),!(null==(c=null==b?void 0:b.params)?void 0:c.apikey))throw Error("API key is required to connect to Realtime");this.apiKey=b.params.apikey,this.endPoint=`${a}/${D.websocket}`,this.httpEndpoint=c5(a),this._initializeOptions(b),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==b?void 0:b.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=cU.createWebSocket(this.endpointURL())}catch(b){this._setConnectionState("disconnected");let a=b.message;if(a.includes("Node.js"))throw Error(`${a}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`);throw Error(`WebSocket not available: ${a}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(a,b){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){let c=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(c),this._setConnectionState("disconnected")},"function"==typeof this.conn.close&&(a?this.conn.close(a,null!=b?b:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(a){let b=await a.unsubscribe();return 0===this.channels.length&&this.disconnect(),b}async removeAllChannels(){let a=await Promise.all(this.channels.map(a=>a.unsubscribe()));return this.channels=[],this.disconnect(),a}log(a,b,c){this.logger(a,b,c)}connectionState(){switch(this.conn&&this.conn.readyState){case A.connecting:return E.Connecting;case A.open:return E.Open;case A.closing:return E.Closing;default:return E.Closed}}isConnected(){return this.connectionState()===E.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(a,b={config:{}}){let c=`realtime:${a}`,d=this.getChannels().find(a=>a.topic===c);if(d)return d;{let c=new c8(`realtime:${a}`,b,this);return this.channels.push(c),c}}push(a){let{topic:b,event:c,payload:d,ref:e}=a,f=()=>{this.encode(a,a=>{var b;null==(b=this.conn)||b.send(a)})};this.log("push",`${b} ${c} (${e})`,d),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(a=null){this._authPromise=this._performAuth(a);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var a;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(a){this.log("error","error in heartbeat callback",a)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(a){this.log("error","error in heartbeat callback",a)}this._wasManualDisconnect=!1,null==(a=this.conn)||a.close(1e3,"heartbeat timeout"),setTimeout(()=>{var a;this.isConnected()||null==(a=this.reconnectTimer)||a.scheduleTimeout()},100);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(a){this.log("error","error in heartbeat callback",a)}this._setAuthSafely("heartbeat")}onHeartbeat(a){this.heartbeatCallback=a}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let b=this.channels.find(b=>b.topic===a&&(b._isJoined()||b._isJoining()));b&&(this.log("transport",`leaving duplicate topic "${a}"`),b.unsubscribe())}_remove(a){this.channels=this.channels.filter(b=>b.topic!==a.topic)}_onConnMessage(a){this.decode(a.data,a=>{if("phoenix"===a.topic&&"phx_reply"===a.event)try{this.heartbeatCallback("ok"===a.payload.status?"ok":"error")}catch(a){this.log("error","error in heartbeat callback",a)}a.ref&&a.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);let{topic:b,event:c,payload:d,ref:e}=a,f=e?`(${e})`:"",g=d.status||"";this.log("receive",`${g} ${b} ${c} ${f}`.trim(),d),this.channels.filter(a=>a._isMember(b)).forEach(a=>a._trigger(c,d,e)),this._triggerStateCallbacks("message",a)})}_clearTimer(a){var b;"heartbeat"===a&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===a&&(null==(b=this.reconnectTimer)||b.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a),this.conn.readyState===A.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===A.open||this.conn.readyState===A.connecting)try{this.conn.close()}catch(a){this.log("error","Error closing connection",a)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(a=>a.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(a=>{this.log("error","error waiting for auth on connect",a),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=a=>{this.log("worker","worker error",a.message),this._terminateWorker()},this.workerRef.onmessage=a=>{"keepAlive"===a.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(a){var b;this._setConnectionState("disconnected"),this.log("transport","close",a),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null==(b=this.reconnectTimer)||b.scheduleTimeout(),this._triggerStateCallbacks("close",a)}_onConnError(a){this._setConnectionState("disconnected"),this.log("transport",`${a}`),this._triggerChanError(),this._triggerStateCallbacks("error",a)}_triggerChanError(){this.channels.forEach(a=>a._trigger(C.error))}_appendParams(a,b){if(0===Object.keys(b).length)return a;let c=a.match(/\?/)?"&":"?",d=new URLSearchParams(b);return`${a}${c}${d}`}_workerObjectUrl(a){let b;if(a)b=a;else{let a=new Blob([db],{type:"application/javascript"});b=URL.createObjectURL(a)}return b}_setConnectionState(a,b=!1){this._connectionState=a,"connecting"===a?this._wasManualDisconnect=!1:"disconnecting"===a&&(this._wasManualDisconnect=b)}async _performAuth(a=null){let b,c=!1;if(a)b=a,c=!0;else if(this.accessToken)try{b=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),b=this.accessTokenValue}else b=this.accessTokenValue;c?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=b&&(this.accessTokenValue=b,this.channels.forEach(a=>{let c={access_token:b,version:"realtime-js/2.89.0"};b&&a.updateJoinPayload(c),a.joinedOnce&&a._isJoined()&&a._push(C.access_token,{access_token:b})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(a="general"){this._isManualToken()||this.setAuth().catch(b=>{this.log("error",`Error setting auth in ${a}`,b)})}_triggerStateCallbacks(a,b){try{this.stateChangeCallbacks[a].forEach(c=>{try{c(b)}catch(b){this.log("error",`error in ${a} callback`,b)}})}catch(b){this.log("error",`error triggering ${a} callbacks`,b)}}_setupReconnectionTimer(){this.reconnectTimer=new cX(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},10)},this.reconnectAfterMs)}_initializeOptions(a){var b,c,d,e,f,g,h,i,j,k,l,m;switch(this.transport=null!=(b=null==a?void 0:a.transport)?b:null,this.timeout=null!=(c=null==a?void 0:a.timeout)?c:1e4,this.heartbeatIntervalMs=null!=(d=null==a?void 0:a.heartbeatIntervalMs)?d:25e3,this.worker=null!=(e=null==a?void 0:a.worker)&&e,this.accessToken=null!=(f=null==a?void 0:a.accessToken)?f:null,this.heartbeatCallback=null!=(g=null==a?void 0:a.heartbeatCallback)?g:c9,this.vsn=null!=(h=null==a?void 0:a.vsn)?h:cV,(null==a?void 0:a.params)&&(this.params=a.params),(null==a?void 0:a.logger)&&(this.logger=a.logger),((null==a?void 0:a.logLevel)||(null==a?void 0:a.log_level))&&(this.logLevel=a.logLevel||a.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!=(i=null==a?void 0:a.reconnectAfterMs)?i:a=>da[a-1]||1e4,this.vsn){case cV:this.encode=null!=(j=null==a?void 0:a.encode)?j:(a,b)=>b(JSON.stringify(a)),this.decode=null!=(k=null==a?void 0:a.decode)?k:(a,b)=>b(JSON.parse(a));break;case"2.0.0":this.encode=null!=(l=null==a?void 0:a.encode)?l:this.serializer.encode.bind(this.serializer),this.decode=null!=(m=null==a?void 0:a.decode)?m:this.serializer.decode.bind(this.serializer);break;default:throw Error(`Unsupported serializer version: ${this.vsn}`)}this.worker&&(this.workerUrl=null==a?void 0:a.workerUrl)}}var dd=class extends Error{constructor(a,b){super(a),this.name="IcebergError",this.status=b.status,this.icebergType=b.icebergType,this.icebergCode=b.icebergCode,this.details=b.details,this.isCommitStateUnknown="CommitStateUnknownException"===b.icebergType||[500,502,504].includes(b.status)&&b.icebergType?.includes("CommitState")===!0}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};async function de(a){return a&&"none"!==a.type?"bearer"===a.type?{Authorization:`Bearer ${a.token}`}:"header"===a.type?{[a.name]:a.value}:"custom"===a.type?await a.getHeaders():{}:{}}function df(a){return a.join("\x1f")}var dg=class{constructor(a,b=""){this.client=a,this.prefix=b}async listNamespaces(a){let b=a?{parent:df(a.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:b})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(a,b){let c={namespace:a.namespace,properties:b?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:c})).data}async dropNamespace(a){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${df(a.namespace)}`})}async loadNamespaceMetadata(a){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${df(a.namespace)}`})).data.properties}}async namespaceExists(a){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${df(a.namespace)}`}),!0}catch(a){if(a instanceof dd&&404===a.status)return!1;throw a}}async createNamespaceIfNotExists(a,b){try{return await this.createNamespace(a,b)}catch(a){if(a instanceof dd&&409===a.status)return;throw a}}};function dh(a){return a.join("\x1f")}var di=class{constructor(a,b="",c){this.client=a,this.prefix=b,this.accessDelegation=c}async listTables(a){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${dh(a.namespace)}/tables`})).data.identifiers}async createTable(a,b){let c={};return this.accessDelegation&&(c["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${dh(a.namespace)}/tables`,body:b,headers:c})).data.metadata}async updateTable(a,b){let c=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${dh(a.namespace)}/tables/${a.name}`,body:b});return{"metadata-location":c.data["metadata-location"],metadata:c.data.metadata}}async dropTable(a,b){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${dh(a.namespace)}/tables/${a.name}`,query:{purgeRequested:String(b?.purge??!1)}})}async loadTable(a){let b={};return this.accessDelegation&&(b["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${dh(a.namespace)}/tables/${a.name}`,headers:b})).data.metadata}async tableExists(a){let b={};this.accessDelegation&&(b["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${dh(a.namespace)}/tables/${a.name}`,headers:b}),!0}catch(a){if(a instanceof dd&&404===a.status)return!1;throw a}}async createTableIfNotExists(a,b){try{return await this.createTable(a,b)}catch(c){if(c instanceof dd&&409===c.status)return await this.loadTable({namespace:a.namespace,name:b.name});throw c}}},dj=class{constructor(a){let b="v1";a.catalogName&&(b+=`/${a.catalogName}`);const c=a.baseUrl.endsWith("/")?a.baseUrl:`${a.baseUrl}/`;this.client=function(a){let b=a.fetchImpl??globalThis.fetch;return{async request({method:c,path:d,query:e,body:f,headers:g}){let h=function(a,b,c){let d=new URL(b,a);if(c)for(let[a,b]of Object.entries(c))void 0!==b&&d.searchParams.set(a,b);return d.toString()}(a.baseUrl,d,e),i=await de(a.auth),j=await b(h,{method:c,headers:{...f?{"Content-Type":"application/json"}:{},...i,...g},body:f?JSON.stringify(f):void 0}),k=await j.text(),l=(j.headers.get("content-type")||"").includes("application/json"),m=l&&k?JSON.parse(k):k;if(!j.ok){let a=l?m:void 0,b=a?.error;throw new dd(b?.message??`Request failed with status ${j.status}`,{status:j.status,icebergType:b?.type,icebergCode:b?.code,details:a})}return{status:j.status,headers:j.headers,data:m}}}}({baseUrl:c,auth:a.auth,fetchImpl:a.fetch}),this.accessDelegation=a.accessDelegation?.join(","),this.namespaceOps=new dg(this.client,b),this.tableOps=new di(this.client,b,this.accessDelegation)}async listNamespaces(a){return this.namespaceOps.listNamespaces(a)}async createNamespace(a,b){return this.namespaceOps.createNamespace(a,b)}async dropNamespace(a){await this.namespaceOps.dropNamespace(a)}async loadNamespaceMetadata(a){return this.namespaceOps.loadNamespaceMetadata(a)}async listTables(a){return this.tableOps.listTables(a)}async createTable(a,b){return this.tableOps.createTable(a,b)}async updateTable(a,b){return this.tableOps.updateTable(a,b)}async dropTable(a,b){await this.tableOps.dropTable(a,b)}async loadTable(a){return this.tableOps.loadTable(a)}async namespaceExists(a){return this.namespaceOps.namespaceExists(a)}async tableExists(a){return this.tableOps.tableExists(a)}async createNamespaceIfNotExists(a,b){return this.namespaceOps.createNamespaceIfNotExists(a,b)}async createTableIfNotExists(a,b){return this.tableOps.createTableIfNotExists(a,b)}},dk=class extends Error{constructor(a){super(a),this.__isStorageError=!0,this.name="StorageError"}};function dl(a){return"object"==typeof a&&null!==a&&"__isStorageError"in a}var dm=class extends dk{constructor(a,b,c){super(a),this.name="StorageApiError",this.status=b,this.statusCode=c}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},dn=class extends dk{constructor(a,b){super(a),this.name="StorageUnknownError",this.originalError=b}};let dp=a=>a?(...b)=>a(...b):(...a)=>fetch(...a),dq=a=>{if(Array.isArray(a))return a.map(a=>dq(a));if("function"==typeof a||a!==Object(a))return a;let b={};return Object.entries(a).forEach(([a,c])=>{b[a.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""))]=dq(c)}),b};function dr(a){return(dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function ds(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function dt(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?ds(Object(c),!0).forEach(function(b){!function(a,b,c){var d;(d=function(a,b){if("object"!=dr(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=dr(d))return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(b,"string"),(b="symbol"==dr(d)?d:d+"")in a)?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c}(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):ds(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}let du=a=>{var b;return a.msg||a.message||a.error_description||("string"==typeof a.error?a.error:null==(b=a.error)?void 0:b.message)||JSON.stringify(a)},dv=async(a,b,c)=>{a instanceof await Response&&!(null==c?void 0:c.noResolveJson)?a.json().then(c=>{let d=a.status||500,e=(null==c?void 0:c.statusCode)||d+"";b(new dm(du(c),d,e))}).catch(a=>{b(new dn(du(a),a))}):b(new dn(du(a),a))};async function dw(a,b,c,d,e,f){return new Promise((g,h)=>{let i;a(c,(i={method:b,headers:(null==d?void 0:d.headers)||{}},"GET"===b||!f?i:((a=>{if("object"!=typeof a||null===a)return!1;let b=Object.getPrototypeOf(a);return(null===b||b===Object.prototype||null===Object.getPrototypeOf(b))&&!(Symbol.toStringTag in a)&&!(Symbol.iterator in a)})(f)?(i.headers=dt({"Content-Type":"application/json"},null==d?void 0:d.headers),i.body=JSON.stringify(f)):i.body=f,(null==d?void 0:d.duplex)&&(i.duplex=d.duplex),dt(dt({},i),e)))).then(a=>{if(!a.ok)throw a;return(null==d?void 0:d.noResolveJson)?a:a.json()}).then(a=>g(a)).catch(a=>dv(a,h,d))})}async function dx(a,b,c,d){return dw(a,"GET",b,c,d)}async function dy(a,b,c,d,e){return dw(a,"POST",b,d,e,c)}async function dz(a,b,c,d,e){return dw(a,"PUT",b,d,e,c)}async function dA(a,b,c,d){return dw(a,"HEAD",b,dt(dt({},c),{},{noResolveJson:!0}),d)}async function dB(a,b,c,d,e){return dw(a,"DELETE",b,d,e,c)}var dC=class{constructor(a,b){this.downloadFn=a,this.shouldThrowOnError=b}then(a,b){return this.execute().then(a,b)}async execute(){try{return{data:(await this.downloadFn()).body,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}};b=Symbol.toStringTag;var dD=class{constructor(a,c){this.downloadFn=a,this.shouldThrowOnError=c,this[b]="BlobDownloadBuilder",this.promise=null}asStream(){return new dC(this.downloadFn,this.shouldThrowOnError)}then(a,b){return this.getPromise().then(a,b)}catch(a){return this.getPromise().catch(a)}finally(a){return this.getPromise().finally(a)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){try{return{data:await (await this.downloadFn()).blob(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}};let dE={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},dF={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var dG=class{constructor(a,b={},c,d){this.shouldThrowOnError=!1,this.url=a,this.headers=b,this.bucketId=c,this.fetch=dp(d)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(a,b,c,d){try{let e,f=dt(dt({},dF),d),g=dt(dt({},this.headers),"POST"===a&&{"x-upsert":String(f.upsert)}),h=f.metadata;"undefined"!=typeof Blob&&c instanceof Blob?((e=new FormData).append("cacheControl",f.cacheControl),h&&e.append("metadata",this.encodeMetadata(h)),e.append("",c)):"undefined"!=typeof FormData&&c instanceof FormData?((e=c).has("cacheControl")||e.append("cacheControl",f.cacheControl),h&&!e.has("metadata")&&e.append("metadata",this.encodeMetadata(h))):(e=c,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType,h&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(h))),("undefined"!=typeof ReadableStream&&e instanceof ReadableStream||e&&"object"==typeof e&&"pipe"in e&&"function"==typeof e.pipe)&&!f.duplex&&(f.duplex="half")),(null==d?void 0:d.headers)&&(g=dt(dt({},g),d.headers));let i=this._removeEmptyFolders(b),j=this._getFinalPath(i),k=await ("PUT"==a?dz:dy)(this.fetch,`${this.url}/object/${j}`,e,dt({headers:g},(null==f?void 0:f.duplex)?{duplex:f.duplex}:{}));return{data:{path:i,id:k.Id,fullPath:k.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}async upload(a,b,c){return this.uploadOrUpdate("POST",a,b,c)}async uploadToSignedUrl(a,b,c,d){let e=this._removeEmptyFolders(a),f=this._getFinalPath(e),g=new URL(this.url+`/object/upload/sign/${f}`);g.searchParams.set("token",b);try{let a,b=dt({upsert:dF.upsert},d),f=dt(dt({},this.headers),{"x-upsert":String(b.upsert)});return"undefined"!=typeof Blob&&c instanceof Blob?((a=new FormData).append("cacheControl",b.cacheControl),a.append("",c)):"undefined"!=typeof FormData&&c instanceof FormData?(a=c).append("cacheControl",b.cacheControl):(a=c,f["cache-control"]=`max-age=${b.cacheControl}`,f["content-type"]=b.contentType),{data:{path:e,fullPath:(await dz(this.fetch,g.toString(),a,{headers:f})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}async createSignedUploadUrl(a,b){try{let c=this._getFinalPath(a),d=dt({},this.headers);(null==b?void 0:b.upsert)&&(d["x-upsert"]="true");let e=await dy(this.fetch,`${this.url}/object/upload/sign/${c}`,{},{headers:d}),f=new URL(this.url+e.url),g=f.searchParams.get("token");if(!g)throw new dk("No token returned by API");return{data:{signedUrl:f.toString(),path:a,token:g},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}async update(a,b,c){return this.uploadOrUpdate("PUT",a,b,c)}async move(a,b,c){try{return{data:await dy(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:a,destinationKey:b,destinationBucket:null==c?void 0:c.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}async copy(a,b,c){try{return{data:{path:(await dy(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:a,destinationKey:b,destinationBucket:null==c?void 0:c.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}async createSignedUrl(a,b,c){try{let d=this._getFinalPath(a),e=await dy(this.fetch,`${this.url}/object/sign/${d}`,dt({expiresIn:b},(null==c?void 0:c.transform)?{transform:c.transform}:{}),{headers:this.headers}),f=(null==c?void 0:c.download)?`&download=${!0===c.download?"":c.download}`:"";return{data:e={signedUrl:encodeURI(`${this.url}${e.signedURL}${f}`)},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}async createSignedUrls(a,b,c){var d=this;try{let e=await dy(d.fetch,`${d.url}/object/sign/${d.bucketId}`,{expiresIn:b,paths:a},{headers:d.headers}),f=(null==c?void 0:c.download)?`&download=${!0===c.download?"":c.download}`:"";return{data:e.map(a=>dt(dt({},a),{},{signedUrl:a.signedURL?encodeURI(`${d.url}${a.signedURL}${f}`):null})),error:null}}catch(a){if(d.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}download(a,b){let c=void 0!==(null==b?void 0:b.transform)?"render/image/authenticated":"object",d=this.transformOptsToQueryString((null==b?void 0:b.transform)||{}),e=d?`?${d}`:"",f=this._getFinalPath(a);return new dD(()=>dx(this.fetch,`${this.url}/${c}/${f}${e}`,{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}async info(a){let b=this._getFinalPath(a);try{return{data:dq(await dx(this.fetch,`${this.url}/object/info/${b}`,{headers:this.headers})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}async exists(a){let b=this._getFinalPath(a);try{return await dA(this.fetch,`${this.url}/object/${b}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a)&&a instanceof dn){let b=a.originalError;if([400,404].includes(null==b?void 0:b.status))return{data:!1,error:a}}throw a}}getPublicUrl(a,b){let c=this._getFinalPath(a),d=[],e=(null==b?void 0:b.download)?`download=${!0===b.download?"":b.download}`:"";""!==e&&d.push(e);let f=void 0!==(null==b?void 0:b.transform)?"render/image":"object",g=this.transformOptsToQueryString((null==b?void 0:b.transform)||{});""!==g&&d.push(g);let h=d.join("&");return""!==h&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${f}/public/${c}${h}`)}}}async remove(a){try{return{data:await dB(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:a},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}async list(a,b,c){try{let d=dt(dt(dt({},dE),b),{},{prefix:a||""});return{data:await dy(this.fetch,`${this.url}/object/list/${this.bucketId}`,d,{headers:this.headers},c),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}async listV2(a,b){try{let c=dt({},a);return{data:await dy(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,c,{headers:this.headers},b),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return"undefined"!=typeof Buffer?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a.replace(/^\/+/,"")}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){let b=[];return a.width&&b.push(`width=${a.width}`),a.height&&b.push(`height=${a.height}`),a.resize&&b.push(`resize=${a.resize}`),a.format&&b.push(`format=${a.format}`),a.quality&&b.push(`quality=${a.quality}`),b.join("&")}};let dH="2.89.0",dI={"X-Client-Info":`storage-js/${dH}`};var dJ=class{constructor(a,b={},c,d){this.shouldThrowOnError=!1;const e=new URL(a);(null==d?void 0:d.useNewHostname)&&/supabase\.(co|in|red)$/.test(e.hostname)&&!e.hostname.includes("storage.supabase.")&&(e.hostname=e.hostname.replace("supabase.","storage.supabase.")),this.url=e.href.replace(/\/$/,""),this.headers=dt(dt({},dI),b),this.fetch=dp(c)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(a){try{let b=this.listBucketOptionsToQueryString(a);return{data:await dx(this.fetch,`${this.url}/bucket${b}`,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}async getBucket(a){try{return{data:await dx(this.fetch,`${this.url}/bucket/${a}`,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}async createBucket(a,b={public:!1}){try{return{data:await dy(this.fetch,`${this.url}/bucket`,{id:a,name:a,type:b.type,public:b.public,file_size_limit:b.fileSizeLimit,allowed_mime_types:b.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}async updateBucket(a,b){try{return{data:await dz(this.fetch,`${this.url}/bucket/${a}`,{id:a,name:a,public:b.public,file_size_limit:b.fileSizeLimit,allowed_mime_types:b.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}async emptyBucket(a){try{return{data:await dy(this.fetch,`${this.url}/bucket/${a}/empty`,{},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}async deleteBucket(a){try{return{data:await dB(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}listBucketOptionsToQueryString(a){let b={};return a&&("limit"in a&&(b.limit=String(a.limit)),"offset"in a&&(b.offset=String(a.offset)),a.search&&(b.search=a.search),a.sortColumn&&(b.sortColumn=a.sortColumn),a.sortOrder&&(b.sortOrder=a.sortOrder)),Object.keys(b).length>0?"?"+new URLSearchParams(b).toString():""}},dK=class{constructor(a,b={},c){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=dt(dt({},dI),b),this.fetch=dp(c)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(a){try{return{data:await dy(this.fetch,`${this.url}/bucket`,{name:a},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}async listBuckets(a){try{let b=new URLSearchParams;(null==a?void 0:a.limit)!==void 0&&b.set("limit",a.limit.toString()),(null==a?void 0:a.offset)!==void 0&&b.set("offset",a.offset.toString()),(null==a?void 0:a.sortColumn)&&b.set("sortColumn",a.sortColumn),(null==a?void 0:a.sortOrder)&&b.set("sortOrder",a.sortOrder),(null==a?void 0:a.search)&&b.set("search",a.search);let c=b.toString(),d=c?`${this.url}/bucket?${c}`:`${this.url}/bucket`;return{data:await dx(this.fetch,d,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}async deleteBucket(a){try{return{data:await dB(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dl(a))return{data:null,error:a};throw a}}from(a){var b=this;if(!(!(!a||"string"!=typeof a||0===a.length||a.length>100||a.trim()!==a||a.includes("/")||a.includes("\\"))&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(a)))throw new dk("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");let c=new dj({baseUrl:this.url,catalogName:a,auth:{type:"custom",getHeaders:async()=>b.headers},fetch:this.fetch}),d=this.shouldThrowOnError;return new Proxy(c,{get(a,b){let c=a[b];return"function"!=typeof c?c:async(...b)=>{try{return{data:await c.apply(a,b),error:null}}catch(a){if(d)throw a;return{data:null,error:a}}}}})}};let dL={"X-Client-Info":`storage-js/${dH}`,"Content-Type":"application/json"};var dM=class extends Error{constructor(a){super(a),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function dN(a){return"object"==typeof a&&null!==a&&"__isStorageVectorsError"in a}var dO=class extends dM{constructor(a,b,c){super(a),this.name="StorageVectorsApiError",this.status=b,this.statusCode=c}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},dP=class extends dM{constructor(a,b){super(a),this.name="StorageVectorsUnknownError",this.originalError=b}};let dQ=a=>a?(...b)=>a(...b):(...a)=>fetch(...a),dR=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),dS=async(a,b,c)=>{if(a&&"object"==typeof a&&"status"in a&&"ok"in a&&"number"==typeof a.status&&!(null==c?void 0:c.noResolveJson)){let c=a.status||500;"function"==typeof a.json?a.json().then(a=>{let d=(null==a?void 0:a.statusCode)||(null==a?void 0:a.code)||c+"";b(new dO(dR(a),c,d))}).catch(()=>{b(new dO(a.statusText||`HTTP ${c} error`,c,c+""))}):b(new dO(a.statusText||`HTTP ${c} error`,c,c+""))}else b(new dP(dR(a),a))};async function dT(a,b,c,d,e,f){return new Promise((g,h)=>{let i;a(c,(i={method:b,headers:(null==d?void 0:d.headers)||{}},"GET"===b||!f?i:((a=>{if("object"!=typeof a||null===a)return!1;let b=Object.getPrototypeOf(a);return(null===b||b===Object.prototype||null===Object.getPrototypeOf(b))&&!(Symbol.toStringTag in a)&&!(Symbol.iterator in a)})(f)?(i.headers=dt({"Content-Type":"application/json"},null==d?void 0:d.headers),i.body=JSON.stringify(f)):i.body=f,dt(dt({},i),e)))).then(a=>{if(!a.ok)throw a;if(null==d?void 0:d.noResolveJson)return a;let b=a.headers.get("content-type");return b&&b.includes("application/json")?a.json():{}}).then(a=>g(a)).catch(a=>dS(a,h,d))})}async function dU(a,b,c,d,e){return dT(a,"POST",b,d,e,c)}var dV=class{constructor(a,b={},c){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=dt(dt({},dL),b),this.fetch=dQ(c)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(a){try{return{data:await dU(this.fetch,`${this.url}/CreateIndex`,a,{headers:this.headers})||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dN(a))return{data:null,error:a};throw a}}async getIndex(a,b){try{return{data:await dU(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:a,indexName:b},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dN(a))return{data:null,error:a};throw a}}async listIndexes(a){try{return{data:await dU(this.fetch,`${this.url}/ListIndexes`,a,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dN(a))return{data:null,error:a};throw a}}async deleteIndex(a,b){try{return{data:await dU(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:a,indexName:b},{headers:this.headers})||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dN(a))return{data:null,error:a};throw a}}},dW=class{constructor(a,b={},c){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=dt(dt({},dL),b),this.fetch=dQ(c)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(a){try{if(a.vectors.length<1||a.vectors.length>500)throw Error("Vector batch size must be between 1 and 500 items");return{data:await dU(this.fetch,`${this.url}/PutVectors`,a,{headers:this.headers})||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dN(a))return{data:null,error:a};throw a}}async getVectors(a){try{return{data:await dU(this.fetch,`${this.url}/GetVectors`,a,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dN(a))return{data:null,error:a};throw a}}async listVectors(a){try{if(void 0!==a.segmentCount){if(a.segmentCount<1||a.segmentCount>16)throw Error("segmentCount must be between 1 and 16");if(void 0!==a.segmentIndex&&(a.segmentIndex<0||a.segmentIndex>=a.segmentCount))throw Error(`segmentIndex must be between 0 and ${a.segmentCount-1}`)}return{data:await dU(this.fetch,`${this.url}/ListVectors`,a,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dN(a))return{data:null,error:a};throw a}}async queryVectors(a){try{return{data:await dU(this.fetch,`${this.url}/QueryVectors`,a,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dN(a))return{data:null,error:a};throw a}}async deleteVectors(a){try{if(a.keys.length<1||a.keys.length>500)throw Error("Keys batch size must be between 1 and 500 items");return{data:await dU(this.fetch,`${this.url}/DeleteVectors`,a,{headers:this.headers})||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dN(a))return{data:null,error:a};throw a}}},dX=class{constructor(a,b={},c){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=dt(dt({},dL),b),this.fetch=dQ(c)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(a){try{return{data:await dU(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:a},{headers:this.headers})||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dN(a))return{data:null,error:a};throw a}}async getBucket(a){try{return{data:await dU(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:a},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dN(a))return{data:null,error:a};throw a}}async listBuckets(a={}){try{return{data:await dU(this.fetch,`${this.url}/ListVectorBuckets`,a,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dN(a))return{data:null,error:a};throw a}}async deleteBucket(a){try{return{data:await dU(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:a},{headers:this.headers})||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dN(a))return{data:null,error:a};throw a}}},dY=class extends dX{constructor(a,b={}){super(a,b.headers||{},b.fetch)}from(a){return new dZ(this.url,this.headers,a,this.fetch)}async createBucket(a){return super.createBucket.call(this,a)}async getBucket(a){return super.getBucket.call(this,a)}async listBuckets(a={}){return super.listBuckets.call(this,a)}async deleteBucket(a){return super.deleteBucket.call(this,a)}},dZ=class extends dV{constructor(a,b,c,d){super(a,b,d),this.vectorBucketName=c}async createIndex(a){return super.createIndex.call(this,dt(dt({},a),{},{vectorBucketName:this.vectorBucketName}))}async listIndexes(a={}){return super.listIndexes.call(this,dt(dt({},a),{},{vectorBucketName:this.vectorBucketName}))}async getIndex(a){return super.getIndex.call(this,this.vectorBucketName,a)}async deleteIndex(a){return super.deleteIndex.call(this,this.vectorBucketName,a)}index(a){return new d$(this.url,this.headers,this.vectorBucketName,a,this.fetch)}},d$=class extends dW{constructor(a,b,c,d,e){super(a,b,e),this.vectorBucketName=c,this.indexName=d}async putVectors(a){return super.putVectors.call(this,dt(dt({},a),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async getVectors(a){return super.getVectors.call(this,dt(dt({},a),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async listVectors(a={}){return super.listVectors.call(this,dt(dt({},a),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async queryVectors(a){return super.queryVectors.call(this,dt(dt({},a),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async deleteVectors(a){return super.deleteVectors.call(this,dt(dt({},a),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}},d_=class extends dJ{constructor(a,b={},c,d){super(a,b,c,d)}from(a){return new dG(this.url,this.headers,a,this.fetch)}get vectors(){return new dY(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new dK(this.url+"/iceberg",this.headers,this.fetch)}};let d0="2.89.0",d1={"X-Client-Info":`gotrue-js/${d0}`},d2="X-Supabase-Api-Version",d3={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},d4=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class d5 extends Error{constructor(a,b,c){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=b,this.code=c}}function d6(a){return"object"==typeof a&&null!==a&&"__isAuthError"in a}class d7 extends d5{constructor(a,b,c){super(a,b,c),this.name="AuthApiError",this.status=b,this.code=c}}class d8 extends d5{constructor(a,b){super(a),this.name="AuthUnknownError",this.originalError=b}}class d9 extends d5{constructor(a,b,c,d){super(a,c,d),this.name=b,this.status=c}}class ea extends d9{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class eb extends d9{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ec extends d9{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class ed extends d9{constructor(a,b=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=b}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ee extends d9{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class ef extends d9{constructor(a,b){super(a,"AuthRetryableFetchError",b,void 0)}}function eg(a){return d6(a)&&"AuthRetryableFetchError"===a.name}class eh extends d9{constructor(a,b,c){super(a,"AuthWeakPasswordError",b,"weak_password"),this.reasons=c}}class ei extends d9{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}let ej="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ek=" 	\n\r=".split(""),el=(()=>{let a=Array(128);for(let b=0;b<a.length;b+=1)a[b]=-1;for(let b=0;b<ek.length;b+=1)a[ek[b].charCodeAt(0)]=-2;for(let b=0;b<ej.length;b+=1)a[ej[b].charCodeAt(0)]=b;return a})();function em(a,b,c){if(null!==a)for(b.queue=b.queue<<8|a,b.queuedBits+=8;b.queuedBits>=6;)c(ej[b.queue>>b.queuedBits-6&63]),b.queuedBits-=6;else if(b.queuedBits>0)for(b.queue=b.queue<<6-b.queuedBits,b.queuedBits=6;b.queuedBits>=6;)c(ej[b.queue>>b.queuedBits-6&63]),b.queuedBits-=6}function en(a,b,c){let d=el[a];if(d>-1)for(b.queue=b.queue<<6|d,b.queuedBits+=6;b.queuedBits>=8;)c(b.queue>>b.queuedBits-8&255),b.queuedBits-=8;else if(-2===d)return;else throw Error(`Invalid Base64-URL character "${String.fromCharCode(a)}"`)}function eo(a){let b=[],c=a=>{b.push(String.fromCodePoint(a))},d={utf8seq:0,codepoint:0},e={queue:0,queuedBits:0},f=a=>{!function(a,b,c){if(0===b.utf8seq){if(a<=127)return c(a);for(let c=1;c<6;c+=1)if((a>>7-c&1)==0){b.utf8seq=c;break}if(2===b.utf8seq)b.codepoint=31&a;else if(3===b.utf8seq)b.codepoint=15&a;else if(4===b.utf8seq)b.codepoint=7&a;else throw Error("Invalid UTF-8 sequence");b.utf8seq-=1}else if(b.utf8seq>0){if(a<=127)throw Error("Invalid UTF-8 sequence");b.codepoint=b.codepoint<<6|63&a,b.utf8seq-=1,0===b.utf8seq&&c(b.codepoint)}}(a,d,c)};for(let b=0;b<a.length;b+=1)en(a.charCodeAt(b),e,f);return b.join("")}function ep(a){let b=[],c={queue:0,queuedBits:0},d=a=>{b.push(a)};for(let b=0;b<a.length;b+=1)en(a.charCodeAt(b),c,d);return new Uint8Array(b)}function eq(a){let b=[],c={queue:0,queuedBits:0},d=a=>{b.push(a)};return a.forEach(a=>em(a,c,d)),em(null,c,d),b.join("")}let er=a=>a?(...b)=>a(...b):(...a)=>fetch(...a),es=async(a,b,c)=>{await a.setItem(b,JSON.stringify(c))},et=async(a,b)=>{let c=await a.getItem(b);if(!c)return null;try{return JSON.parse(c)}catch(a){return c}},eu=async(a,b)=>{await a.removeItem(b)};class ev{constructor(){this.promise=new ev.promiseConstructor((a,b)=>{this.resolve=a,this.reject=b})}}function ew(a){let b=a.split(".");if(3!==b.length)throw new ei("Invalid JWT structure");for(let a=0;a<b.length;a++)if(!d4.test(b[a]))throw new ei("JWT not in base64url format");return{header:JSON.parse(eo(b[0])),payload:JSON.parse(eo(b[1])),signature:ep(b[2]),raw:{header:b[0],payload:b[1]}}}async function ex(a){return await new Promise(b=>{setTimeout(()=>b(null),a)})}function ey(a){return("0"+a.toString(16)).substr(-2)}async function ez(a){let b=new TextEncoder().encode(a);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",b))).map(a=>String.fromCharCode(a)).join("")}async function eA(a){return"undefined"==typeof crypto||void 0===crypto.subtle||"undefined"==typeof TextEncoder?(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),a):btoa(await ez(a)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function eB(a,b,c=!1){let d=function(){let a=new Uint32Array(56);if("undefined"==typeof crypto){let a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",b=a.length,c="";for(let d=0;d<56;d++)c+=a.charAt(Math.floor(Math.random()*b));return c}return crypto.getRandomValues(a),Array.from(a,ey).join("")}(),e=d;c&&(e+="/PASSWORD_RECOVERY"),await es(a,`${b}-code-verifier`,e);let f=await eA(d),g=d===f?"plain":"s256";return[f,g]}ev.promiseConstructor=Promise;let eC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i,eD=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function eE(a){if(!eD.test(a))throw Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function eF(){return new Proxy({},{get:(a,b)=>{if("__isUserNotAvailableProxy"===b)return!0;if("symbol"==typeof b){let a=b.toString();if("Symbol(Symbol.toPrimitive)"===a||"Symbol(Symbol.toStringTag)"===a||"Symbol(util.inspect.custom)"===a)return}throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${b}" property of the session object is not supported. Please use getUser() instead.`)},set:(a,b)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${b}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(a,b)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${b}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function eG(a){return JSON.parse(JSON.stringify(a))}let eH=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),eI=[502,503,504];async function eJ(a){var b;let c,d;if(!("object"==typeof a&&null!==a&&"status"in a&&"ok"in a&&"json"in a&&"function"==typeof a.json))throw new ef(eH(a),0);if(eI.includes(a.status))throw new ef(eH(a),a.status);try{c=await a.json()}catch(a){throw new d8(eH(a),a)}let e=function(a){let b=a.headers.get(d2);if(!b||!b.match(eC))return null;try{return new Date(`${b}T00:00:00.0Z`)}catch(a){return null}}(a);if(e&&e.getTime()>=d3["2024-01-01"].timestamp&&"object"==typeof c&&c&&"string"==typeof c.code?d=c.code:"object"==typeof c&&c&&"string"==typeof c.error_code&&(d=c.error_code),d){if("weak_password"===d)throw new eh(eH(c),a.status,(null==(b=c.weak_password)?void 0:b.reasons)||[]);else if("session_not_found"===d)throw new ea}else if("object"==typeof c&&c&&"object"==typeof c.weak_password&&c.weak_password&&Array.isArray(c.weak_password.reasons)&&c.weak_password.reasons.length&&c.weak_password.reasons.reduce((a,b)=>a&&"string"==typeof b,!0))throw new eh(eH(c),a.status,c.weak_password.reasons);throw new d7(eH(c),a.status||500,d)}async function eK(a,b,c,d){var e;let f=Object.assign({},null==d?void 0:d.headers);f[d2]||(f[d2]=d3["2024-01-01"].name),(null==d?void 0:d.jwt)&&(f.Authorization=`Bearer ${d.jwt}`);let g=null!=(e=null==d?void 0:d.query)?e:{};(null==d?void 0:d.redirectTo)&&(g.redirect_to=d.redirectTo);let h=Object.keys(g).length?"?"+new URLSearchParams(g).toString():"",i=await eL(a,b,c+h,{headers:f,noResolveJson:null==d?void 0:d.noResolveJson},{},null==d?void 0:d.body);return(null==d?void 0:d.xform)?null==d?void 0:d.xform(i):{data:Object.assign({},i),error:null}}async function eL(a,b,c,d,e,f){let g,h,i=(h={method:b,headers:(null==d?void 0:d.headers)||{}},"GET"===b?h:(h.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==d?void 0:d.headers),h.body=JSON.stringify(f),Object.assign(Object.assign({},h),e)));try{g=await a(c,Object.assign({},i))}catch(a){throw console.error(a),new ef(eH(a),0)}if(g.ok||await eJ(g),null==d?void 0:d.noResolveJson)return g;try{return await g.json()}catch(a){await eJ(a)}}function eM(a){var b,c,d;let e=null;(d=a).access_token&&d.refresh_token&&d.expires_in&&(e=Object.assign({},a),a.expires_at||(e.expires_at=(c=a.expires_in,Math.round(Date.now()/1e3)+c)));return{data:{session:e,user:null!=(b=a.user)?b:a},error:null}}function eN(a){let b=eM(a);return!b.error&&a.weak_password&&"object"==typeof a.weak_password&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.message&&"string"==typeof a.weak_password.message&&a.weak_password.reasons.reduce((a,b)=>a&&"string"==typeof b,!0)&&(b.data.weak_password=a.weak_password),b}function eO(a){var b;return{data:{user:null!=(b=a.user)?b:a},error:null}}function eP(a){return{data:a,error:null}}function eQ(a){let{action_link:b,email_otp:c,hashed_token:d,redirect_to:e,verification_type:f}=a;return{data:{properties:{action_link:b,email_otp:c,hashed_token:d,redirect_to:e,verification_type:f},user:Object.assign({},az(a,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function eR(a){return a}let eS=["global","local","others"];class eT{constructor({url:a="",headers:b={},fetch:c}){this.url=a,this.headers=b,this.fetch=er(c),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(a,b=eS[0]){if(0>eS.indexOf(b))throw Error(`@supabase/auth-js: Parameter scope must be one of ${eS.join(", ")}`);try{return await eK(this.fetch,"POST",`${this.url}/logout?scope=${b}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(a){if(d6(a))return{data:null,error:a};throw a}}async inviteUserByEmail(a,b={}){try{return await eK(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:b.data},headers:this.headers,redirectTo:b.redirectTo,xform:eO})}catch(a){if(d6(a))return{data:{user:null},error:a};throw a}}async generateLink(a){try{let{options:b}=a,c=az(a,["options"]),d=Object.assign(Object.assign({},c),b);return"newEmail"in c&&(d.new_email=null==c?void 0:c.newEmail,delete d.newEmail),await eK(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:d,headers:this.headers,xform:eQ,redirectTo:null==b?void 0:b.redirectTo})}catch(a){if(d6(a))return{data:{properties:null,user:null},error:a};throw a}}async createUser(a){try{return await eK(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:eO})}catch(a){if(d6(a))return{data:{user:null},error:a};throw a}}async listUsers(a){var b,c,d,e,f,g,h;try{let i={nextPage:null,lastPage:0,total:0},j=await eK(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(c=null==(b=null==a?void 0:a.page)?void 0:b.toString())?c:"",per_page:null!=(e=null==(d=null==a?void 0:a.perPage)?void 0:d.toString())?e:""},xform:eR});if(j.error)throw j.error;let k=await j.json(),l=null!=(f=j.headers.get("x-total-count"))?f:0,m=null!=(h=null==(g=j.headers.get("link"))?void 0:g.split(","))?h:[];return m.length>0&&(m.forEach(a=>{let b=parseInt(a.split(";")[0].split("=")[1].substring(0,1)),c=JSON.parse(a.split(";")[1].split("=")[1]);i[`${c}Page`]=b}),i.total=parseInt(l)),{data:Object.assign(Object.assign({},k),i),error:null}}catch(a){if(d6(a))return{data:{users:[]},error:a};throw a}}async getUserById(a){eE(a);try{return await eK(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:eO})}catch(a){if(d6(a))return{data:{user:null},error:a};throw a}}async updateUserById(a,b){eE(a);try{return await eK(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:b,headers:this.headers,xform:eO})}catch(a){if(d6(a))return{data:{user:null},error:a};throw a}}async deleteUser(a,b=!1){eE(a);try{return await eK(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:b},xform:eO})}catch(a){if(d6(a))return{data:{user:null},error:a};throw a}}async _listFactors(a){eE(a.userId);try{let{data:b,error:c}=await eK(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:b,error:c}}catch(a){if(d6(a))return{data:null,error:a};throw a}}async _deleteFactor(a){eE(a.userId),eE(a.id);try{return{data:await eK(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(a){if(d6(a))return{data:null,error:a};throw a}}async _listOAuthClients(a){var b,c,d,e,f,g,h;try{let i={nextPage:null,lastPage:0,total:0},j=await eK(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(c=null==(b=null==a?void 0:a.page)?void 0:b.toString())?c:"",per_page:null!=(e=null==(d=null==a?void 0:a.perPage)?void 0:d.toString())?e:""},xform:eR});if(j.error)throw j.error;let k=await j.json(),l=null!=(f=j.headers.get("x-total-count"))?f:0,m=null!=(h=null==(g=j.headers.get("link"))?void 0:g.split(","))?h:[];return m.length>0&&(m.forEach(a=>{let b=parseInt(a.split(";")[0].split("=")[1].substring(0,1)),c=JSON.parse(a.split(";")[1].split("=")[1]);i[`${c}Page`]=b}),i.total=parseInt(l)),{data:Object.assign(Object.assign({},k),i),error:null}}catch(a){if(d6(a))return{data:{clients:[]},error:a};throw a}}async _createOAuthClient(a){try{return await eK(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:a,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(d6(a))return{data:null,error:a};throw a}}async _getOAuthClient(a){try{return await eK(this.fetch,"GET",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(d6(a))return{data:null,error:a};throw a}}async _updateOAuthClient(a,b){try{return await eK(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${a}`,{body:b,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(d6(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(a){try{return await eK(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(a){if(d6(a))return{data:null,error:a};throw a}}async _regenerateOAuthClientSecret(a){try{return await eK(this.fetch,"POST",`${this.url}/admin/oauth/clients/${a}/regenerate_secret`,{headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(d6(a))return{data:null,error:a};throw a}}}function eU(a={}){return{getItem:b=>a[b]||null,setItem:(b,c)=>{a[b]=c},removeItem:b=>{delete a[b]}}}globalThis;class eV extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}function eW(a){if(!/^0x[a-fA-F0-9]{40}$/.test(a))throw Error(`@supabase/auth-js: Address "${a}" is invalid.`);return a.toLowerCase()}class eX extends Error{constructor({message:a,code:b,cause:c,name:d}){var e;super(a,{cause:c}),this.__isWebAuthnError=!0,this.name=null!=(e=null!=d?d:c instanceof Error?c.name:void 0)?e:"Unknown Error",this.code=b}}class eY extends eX{constructor(a,b){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:b,message:a}),this.name="WebAuthnUnknownError",this.originalError=b}}let eZ=new class{createNewAbortSignal(){if(this.controller){let a=Error("Cancelling existing WebAuthn API call for new one");a.name="AbortError",this.controller.abort(a)}let a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){let a=Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}};function e$(a){return"localhost"===a||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(a)}async function e_(a){try{let b=await navigator.credentials.create(a);if(!b)return{data:null,error:new eY("Empty credential response",b)};if(!(b instanceof PublicKeyCredential))return{data:null,error:new eY("Browser returned unexpected credential type",b)};return{data:b,error:null}}catch(b){return{data:null,error:function({error:a,options:b}){var c,d,e;let{publicKey:f}=b;if(!f)throw Error("options was missing required publicKey property");if("AbortError"===a.name){if(b.signal instanceof AbortSignal)return new eX({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else if("ConstraintError"===a.name){if((null==(c=f.authenticatorSelection)?void 0:c.requireResidentKey)===!0)return new eX({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:a});else if("conditional"===b.mediation&&(null==(d=f.authenticatorSelection)?void 0:d.userVerification)==="required")return new eX({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:a});else if((null==(e=f.authenticatorSelection)?void 0:e.userVerification)==="required")return new eX({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:a})}else if("InvalidStateError"===a.name)return new eX({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:a});else if("NotAllowedError"===a.name)return new eX({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});else if("NotSupportedError"===a.name)return new eX(0===f.pubKeyCredParams.filter(a=>"public-key"===a.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:a}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:a});else if("SecurityError"===a.name){let b=window.location.hostname;if(!e$(b))return new eX({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a});if(f.rp.id!==b)return new eX({message:`The RP ID "${f.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else if("TypeError"===a.name){if(f.user.id.byteLength<1||f.user.id.byteLength>64)return new eX({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:a})}else if("UnknownError"===a.name)return new eX({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a});return new eX({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a})}({error:b,options:a})}}}async function e0(a){try{let b=await navigator.credentials.get(a);if(!b)return{data:null,error:new eY("Empty credential response",b)};if(!(b instanceof PublicKeyCredential))return{data:null,error:new eY("Browser returned unexpected credential type",b)};return{data:b,error:null}}catch(b){return{data:null,error:function({error:a,options:b}){let{publicKey:c}=b;if(!c)throw Error("options was missing required publicKey property");if("AbortError"===a.name){if(b.signal instanceof AbortSignal)return new eX({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else if("NotAllowedError"===a.name)return new eX({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});else if("SecurityError"===a.name){let b=window.location.hostname;if(!e$(b))return new eX({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a});if(c.rpId!==b)return new eX({message:`The RP ID "${c.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else if("UnknownError"===a.name)return new eX({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a});return new eX({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a})}({error:b,options:a})}}}let e1={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},e2={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function e3(...a){let b=a=>null!==a&&"object"==typeof a&&!Array.isArray(a),c=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),d={};for(let e of a)if(e)for(let a in e){let f=e[a];if(void 0!==f)if(Array.isArray(f))d[a]=f;else if(c(f))d[a]=f;else if(b(f)){let c=d[a];b(c)?d[a]=e3(c,f):d[a]=e3(f)}else d[a]=f}return d}class e4{constructor(a){this.client=a,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(a){return this.client.mfa.enroll(Object.assign(Object.assign({},a),{factorType:"webauthn"}))}async _challenge({factorId:a,webauthn:b,friendlyName:c,signal:d},e){try{var f,g,h,i;let{data:j,error:k}=await this.client.mfa.challenge({factorId:a,webauthn:b});if(!j)return{data:null,error:k};let l=null!=d?d:eZ.createNewAbortSignal();if("create"===j.webauthn.type){let{user:a}=j.webauthn.credential_options.publicKey;a.name||(a.name=`${a.id}:${c}`),a.displayName||(a.displayName=a.name)}switch(j.webauthn.type){case"create":{let b=(f=j.webauthn.credential_options.publicKey,g=null==e?void 0:e.create,e3(e1,f,g||{})),{data:c,error:d}=await e_({publicKey:b,signal:l});if(c)return{data:{factorId:a,challengeId:j.id,webauthn:{type:j.webauthn.type,credential_response:c}},error:null};return{data:null,error:d}}case"request":{let b=(h=j.webauthn.credential_options.publicKey,i=null==e?void 0:e.request,e3(e2,h,i||{})),{data:c,error:d}=await e0(Object.assign(Object.assign({},j.webauthn.credential_options),{publicKey:b,signal:l}));if(c)return{data:{factorId:a,challengeId:j.id,webauthn:{type:j.webauthn.type,credential_response:c}},error:null};return{data:null,error:d}}}}catch(a){if(d6(a))return{data:null,error:a};return{data:null,error:new d8("Unexpected error in challenge",a)}}}async _verify({challengeId:a,factorId:b,webauthn:c}){return this.client.mfa.verify({factorId:b,challengeId:a,webauthn:c})}async _authenticate({factorId:a,webauthn:{rpId:b,rpOrigins:c,signal:d}={}},e){if(!b)return{data:null,error:new d5("rpId is required for WebAuthn authentication")};try{1;return{data:null,error:new d8("Browser does not support WebAuthn",null)}}catch(a){if(d6(a))return{data:null,error:a};return{data:null,error:new d8("Unexpected error in authenticate",a)}}}async _register({friendlyName:a,webauthn:{rpId:b,rpOrigins:c,signal:d}={}},e){if(!b)return{data:null,error:new d5("rpId is required for WebAuthn registration")};try{1;return{data:null,error:new d8("Browser does not support WebAuthn",null)}}catch(a){if(d6(a))return{data:null,error:a};return{data:null,error:new d8("Unexpected error in register",a)}}}}if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(a){"undefined"!=typeof self&&(self.globalThis=self)}let e5={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:d1,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function e6(a,b,c){return await c()}let e7={};class e8{get jwks(){var a,b;return null!=(b=null==(a=e7[this.storageKey])?void 0:a.jwks)?b:{keys:[]}}set jwks(a){e7[this.storageKey]=Object.assign(Object.assign({},e7[this.storageKey]),{jwks:a})}get jwks_cached_at(){var a,b;return null!=(b=null==(a=e7[this.storageKey])?void 0:a.cachedAt)?b:Number.MIN_SAFE_INTEGER}set jwks_cached_at(a){e7[this.storageKey]=Object.assign(Object.assign({},e7[this.storageKey]),{cachedAt:a})}constructor(a){var b;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const c=Object.assign(Object.assign({},e5),a);this.storageKey=c.storageKey,this.instanceID=null!=(b=e8.nextInstanceID[this.storageKey])?b:0,e8.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!c.debug,"function"==typeof c.debug&&(this.logger=c.debug),this.instanceID,this.persistSession=c.persistSession,this.autoRefreshToken=c.autoRefreshToken,this.admin=new eT({url:c.url,headers:c.headers,fetch:c.fetch}),this.url=c.url,this.headers=c.headers,this.fetch=er(c.fetch),this.lock=c.lock||e6,this.detectSessionInUrl=c.detectSessionInUrl,this.flowType=c.flowType,this.hasCustomAuthorizationHeader=c.hasCustomAuthorizationHeader,this.throwOnError=c.throwOnError,c.lock?this.lock=c.lock:(this.persistSession,this.lock=e6),this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new e4(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(c.storage?this.storage=c.storage:(this.memoryStorage={},this.storage=eU(this.memoryStorage)),c.userStorage&&(this.userStorage=c.userStorage)):(this.memoryStorage={},this.storage=eU(this.memoryStorage)),this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(a){if(this.throwOnError&&a&&a.error)throw a.error;return a}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${d0}) ${new Date().toISOString()}`}_debug(...a){return this.logDebugMessages&&this.logger(this._logPrefix(),...a),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){try{return await this._recoverAndRefresh(),{error:null}}catch(a){if(d6(a))return this._returnResult({error:a});return this._returnResult({error:new d8("Unexpected error during initialization",a)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var b,c,d;try{let{data:e,error:f}=await eK(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!=(c=null==(b=null==a?void 0:a.options)?void 0:b.data)?c:{},gotrue_meta_security:{captcha_token:null==(d=null==a?void 0:a.options)?void 0:d.captchaToken}},xform:eM});if(f||!e)return this._returnResult({data:{user:null,session:null},error:f});let g=e.session,h=e.user;return e.session&&(await this._saveSession(e.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:h,session:g},error:null})}catch(a){if(d6(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(a){var b,c,d;try{let e;if("email"in a){let{email:c,password:d,options:f}=a,g=null,h=null;"pkce"===this.flowType&&([g,h]=await eB(this.storage,this.storageKey)),e=await eK(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==f?void 0:f.emailRedirectTo,body:{email:c,password:d,data:null!=(b=null==f?void 0:f.data)?b:{},gotrue_meta_security:{captcha_token:null==f?void 0:f.captchaToken},code_challenge:g,code_challenge_method:h},xform:eM})}else if("phone"in a){let{phone:b,password:f,options:g}=a;e=await eK(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:b,password:f,data:null!=(c=null==g?void 0:g.data)?c:{},channel:null!=(d=null==g?void 0:g.channel)?d:"sms",gotrue_meta_security:{captcha_token:null==g?void 0:g.captchaToken}},xform:eM})}else throw new ec("You must provide either an email or phone number and a password");let{data:f,error:g}=e;if(g||!f)return await eu(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:g});let h=f.session,i=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:i,session:h},error:null})}catch(a){if(await eu(this.storage,`${this.storageKey}-code-verifier`),d6(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(a){try{let b;if("email"in a){let{email:c,password:d,options:e}=a;b=await eK(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}},xform:eN})}else if("phone"in a){let{phone:c,password:d,options:e}=a;b=await eK(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}},xform:eN})}else throw new ec("You must provide either an email or phone number and a password");let{data:c,error:d}=b;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){let a=new eb;return this._returnResult({data:{user:null,session:null},error:a})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:Object.assign({user:c.user,session:c.session},c.weak_password?{weakPassword:c.weak_password}:null),error:d})}catch(a){if(d6(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithOAuth(a){var b,c,d,e;return await this._handleProviderSignIn(a.provider,{redirectTo:null==(b=a.options)?void 0:b.redirectTo,scopes:null==(c=a.options)?void 0:c.scopes,queryParams:null==(d=a.options)?void 0:d.queryParams,skipBrowserRedirect:null==(e=a.options)?void 0:e.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(a))}async signInWithWeb3(a){let{chain:b}=a;switch(b){case"ethereum":return await this.signInWithEthereum(a);case"solana":return await this.signInWithSolana(a);default:throw Error(`@supabase/auth-js: Unsupported chain "${b}"`)}}async signInWithEthereum(a){var b,c,d,e,f,g,h,i,j,k,l,m;let n,o;if("message"in a)n=a.message,o=a.signature;else{let{chain:k,wallet:l,statement:p,options:q}=a;if("object"!=typeof l||!(null==q?void 0:q.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");let r=new URL(null!=(b=null==q?void 0:q.url)?b:window.location.href),s=await l.request({method:"eth_requestAccounts"}).then(a=>a).catch(()=>{throw Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!s||0===s.length)throw Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");let t=eW(s[0]),u=null==(c=null==q?void 0:q.signInWithEthereum)?void 0:c.chainId;u||(u=parseInt(await l.request({method:"eth_chainId"}),16)),n=function(a){var b;let{chainId:c,domain:d,expirationTime:e,issuedAt:f=new Date,nonce:g,notBefore:h,requestId:i,resources:j,scheme:k,uri:l,version:m}=a;if(!Number.isInteger(c))throw Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${c}`);if(!d)throw Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(g&&g.length<8)throw Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${g}`);if(!l)throw Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==m)throw Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${m}`);if(null==(b=a.statement)?void 0:b.includes("\n"))throw Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${a.statement}`);let n=eW(a.address),o=k?`${k}://${d}`:d,p=a.statement?`${a.statement}
`:"",q=`${o} wants you to sign in with your Ethereum account:
${n}

${p}`,r=`URI: ${l}
Version: ${m}
Chain ID: ${c}${g?`
Nonce: ${g}`:""}
Issued At: ${f.toISOString()}`;if(e&&(r+=`
Expiration Time: ${e.toISOString()}`),h&&(r+=`
Not Before: ${h.toISOString()}`),i&&(r+=`
Request ID: ${i}`),j){let a="\nResources:";for(let b of j){if(!b||"string"!=typeof b)throw Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${b}`);a+=`
- ${b}`}r+=a}return`${q}
${r}`}({domain:r.host,address:t,statement:p,uri:r.href,version:"1",chainId:u,nonce:null==(d=null==q?void 0:q.signInWithEthereum)?void 0:d.nonce,issuedAt:null!=(f=null==(e=null==q?void 0:q.signInWithEthereum)?void 0:e.issuedAt)?f:new Date,expirationTime:null==(g=null==q?void 0:q.signInWithEthereum)?void 0:g.expirationTime,notBefore:null==(h=null==q?void 0:q.signInWithEthereum)?void 0:h.notBefore,requestId:null==(i=null==q?void 0:q.signInWithEthereum)?void 0:i.requestId,resources:null==(j=null==q?void 0:q.signInWithEthereum)?void 0:j.resources}),o=await l.request({method:"personal_sign",params:[(m=n,"0x"+Array.from(new TextEncoder().encode(m),a=>a.toString(16).padStart(2,"0")).join("")),t]})}try{let{data:b,error:c}=await eK(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:n,signature:o},(null==(k=a.options)?void 0:k.captchaToken)?{gotrue_meta_security:{captcha_token:null==(l=a.options)?void 0:l.captchaToken}}:null),xform:eM});if(c)throw c;if(!b||!b.session||!b.user){let a=new eb;return this._returnResult({data:{user:null,session:null},error:a})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:c})}catch(a){if(d6(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSolana(a){var b,c,d,e,f,g,h,i,j,k,l,m;let n,o;if("message"in a)n=a.message,o=a.signature;else{let{chain:l,wallet:m,statement:p,options:q}=a;if("object"!=typeof m||!(null==q?void 0:q.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");let r=new URL(null!=(b=null==q?void 0:q.url)?b:window.location.href);if("signIn"in m&&m.signIn){let a,b=await m.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},null==q?void 0:q.signInWithSolana),{version:"1",domain:r.host,uri:r.href}),p?{statement:p}:null));if(Array.isArray(b)&&b[0]&&"object"==typeof b[0])a=b[0];else if(b&&"object"==typeof b&&"signedMessage"in b&&"signature"in b)a=b;else throw Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in a&&"signature"in a&&("string"==typeof a.signedMessage||a.signedMessage instanceof Uint8Array)&&a.signature instanceof Uint8Array)n="string"==typeof a.signedMessage?a.signedMessage:new TextDecoder().decode(a.signedMessage),o=a.signature;else throw Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in m)||"function"!=typeof m.signMessage||!("publicKey"in m)||"object"!=typeof m||!m.publicKey||!("toBase58"in m.publicKey)||"function"!=typeof m.publicKey.toBase58)throw Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");n=[`${r.host} wants you to sign in with your Solana account:`,m.publicKey.toBase58(),...p?["",p,""]:[""],"Version: 1",`URI: ${r.href}`,`Issued At: ${null!=(d=null==(c=null==q?void 0:q.signInWithSolana)?void 0:c.issuedAt)?d:new Date().toISOString()}`,...(null==(e=null==q?void 0:q.signInWithSolana)?void 0:e.notBefore)?[`Not Before: ${q.signInWithSolana.notBefore}`]:[],...(null==(f=null==q?void 0:q.signInWithSolana)?void 0:f.expirationTime)?[`Expiration Time: ${q.signInWithSolana.expirationTime}`]:[],...(null==(g=null==q?void 0:q.signInWithSolana)?void 0:g.chainId)?[`Chain ID: ${q.signInWithSolana.chainId}`]:[],...(null==(h=null==q?void 0:q.signInWithSolana)?void 0:h.nonce)?[`Nonce: ${q.signInWithSolana.nonce}`]:[],...(null==(i=null==q?void 0:q.signInWithSolana)?void 0:i.requestId)?[`Request ID: ${q.signInWithSolana.requestId}`]:[],...(null==(k=null==(j=null==q?void 0:q.signInWithSolana)?void 0:j.resources)?void 0:k.length)?["Resources",...q.signInWithSolana.resources.map(a=>`- ${a}`)]:[]].join("\n");let a=await m.signMessage(new TextEncoder().encode(n),"utf8");if(!a||!(a instanceof Uint8Array))throw Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");o=a}}try{let{data:b,error:c}=await eK(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:n,signature:eq(o)},(null==(l=a.options)?void 0:l.captchaToken)?{gotrue_meta_security:{captcha_token:null==(m=a.options)?void 0:m.captchaToken}}:null),xform:eM});if(c)throw c;if(!b||!b.session||!b.user){let a=new eb;return this._returnResult({data:{user:null,session:null},error:a})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:c})}catch(a){if(d6(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async _exchangeCodeForSession(a){let b=await et(this.storage,`${this.storageKey}-code-verifier`),[c,d]=(null!=b?b:"").split("/");try{if(!c&&"pkce"===this.flowType)throw new ee;let{data:b,error:e}=await eK(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:c},xform:eM});if(await eu(this.storage,`${this.storageKey}-code-verifier`),e)throw e;if(!b||!b.session||!b.user){let a=new eb;return this._returnResult({data:{user:null,session:null,redirectType:null},error:a})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign(Object.assign({},b),{redirectType:null!=d?d:null}),error:e})}catch(a){if(await eu(this.storage,`${this.storageKey}-code-verifier`),d6(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(a){try{let{options:b,provider:c,token:d,access_token:e,nonce:f}=a,{data:g,error:h}=await eK(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:c,id_token:d,access_token:e,nonce:f,gotrue_meta_security:{captcha_token:null==b?void 0:b.captchaToken}},xform:eM});if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!g||!g.session||!g.user){let a=new eb;return this._returnResult({data:{user:null,session:null},error:a})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:g,error:h})}catch(a){if(d6(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithOtp(a){var b,c,d,e,f;try{if("email"in a){let{email:d,options:e}=a,f=null,g=null;"pkce"===this.flowType&&([f,g]=await eB(this.storage,this.storageKey));let{error:h}=await eK(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:null!=(b=null==e?void 0:e.data)?b:{},create_user:null==(c=null==e?void 0:e.shouldCreateUser)||c,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken},code_challenge:f,code_challenge_method:g},redirectTo:null==e?void 0:e.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in a){let{phone:b,options:c}=a,{data:g,error:h}=await eK(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:b,data:null!=(d=null==c?void 0:c.data)?d:{},create_user:null==(e=null==c?void 0:c.shouldCreateUser)||e,gotrue_meta_security:{captcha_token:null==c?void 0:c.captchaToken},channel:null!=(f=null==c?void 0:c.channel)?f:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:null==g?void 0:g.message_id},error:h})}throw new ec("You must provide either an email or phone number.")}catch(a){if(await eu(this.storage,`${this.storageKey}-code-verifier`),d6(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async verifyOtp(a){var b,c;try{let d,e;"options"in a&&(d=null==(b=a.options)?void 0:b.redirectTo,e=null==(c=a.options)?void 0:c.captchaToken);let{data:f,error:g}=await eK(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:e}}),redirectTo:d,xform:eM});if(g)throw g;if(!f)throw Error("An error occurred on token verification.");let h=f.session,i=f.user;return(null==h?void 0:h.access_token)&&(await this._saveSession(h),await this._notifyAllSubscribers("recovery"==a.type?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:i,session:h},error:null})}catch(a){if(d6(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(a){var b,c,d,e;try{let f=null,g=null;"pkce"===this.flowType&&([f,g]=await eB(this.storage,this.storageKey));let h=await eK(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:null!=(c=null==(b=a.options)?void 0:b.redirectTo)?c:void 0}),(null==(d=null==a?void 0:a.options)?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:f,code_challenge_method:g}),headers:this.headers,xform:eP});return null==(e=h.data)||e.url,this._returnResult(h)}catch(a){if(await eu(this.storage,`${this.storageKey}-code-verifier`),d6(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{let{data:{session:b},error:c}=a;if(c)throw c;if(!b)throw new ea;let{error:d}=await eK(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:b.access_token});return this._returnResult({data:{user:null,session:null},error:d})})}catch(a){if(d6(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async resend(a){try{let b=`${this.url}/resend`;if("email"in a){let{email:c,type:d,options:e}=a,{error:f}=await eK(this.fetch,"POST",b,{headers:this.headers,body:{email:c,type:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}},redirectTo:null==e?void 0:e.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in a){let{phone:c,type:d,options:e}=a,{data:f,error:g}=await eK(this.fetch,"POST",b,{headers:this.headers,body:{phone:c,type:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null==f?void 0:f.message_id},error:g})}throw new ec("You must provide either an email or phone number and a type")}catch(a){if(d6(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async a=>a))}async _acquireLock(a,b){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){let a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),c=(async()=>(await a,await b()))();return this.pendingInLock.push((async()=>{try{await c}catch(a){}})()),c}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let a=b();for(this.pendingInLock.push((async()=>{try{await a}catch(a){}})()),await a;this.pendingInLock.length;){let a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{let b=await this.__loadSession();return await a(b)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let b=null,c=await et(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",c),null!==c&&(this._isValidSession(c)?b=c:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!b)return{data:{session:null},error:null};let d=!!b.expires_at&&1e3*b.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${d?"":" not"} expired`,"expires_at",b.expires_at),!d){if(this.userStorage){let a=await et(this.userStorage,this.storageKey+"-user");(null==a?void 0:a.user)?b.user=a.user:b.user=eF()}if(this.storage.isServer&&b.user&&!b.user.__isUserNotAvailableProxy){var a;let c={value:this.suppressGetSessionWarning};b.user=(a=b.user,new Proxy(a,{get:(a,b,d)=>{if("__isInsecureUserWarningProxy"===b)return!0;if("symbol"==typeof b){let c=b.toString();if("Symbol(Symbol.toPrimitive)"===c||"Symbol(Symbol.toStringTag)"===c||"Symbol(util.inspect.custom)"===c||"Symbol(nodejs.util.inspect.custom)"===c)return Reflect.get(a,b,d)}return c.value||"string"!=typeof b||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c.value=!0),Reflect.get(a,b,d)}})),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:b},error:null}}let{data:e,error:f}=await this._callRefreshToken(b.refresh_token);if(f)return this._returnResult({data:{session:null},error:f});return this._returnResult({data:{session:e},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(a){if(a)return await this._getUser(a);await this.initializePromise;let b=await this._acquireLock(-1,async()=>await this._getUser());return b.data.user&&(this.suppressGetSessionWarning=!0),b}async _getUser(a){try{if(a)return await eK(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:eO});return await this._useSession(async a=>{var b,c,d;let{data:e,error:f}=a;if(f)throw f;return(null==(b=e.session)?void 0:b.access_token)||this.hasCustomAuthorizationHeader?await eK(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!=(d=null==(c=e.session)?void 0:c.access_token)?d:void 0,xform:eO}):{data:{user:null},error:new ea}})}catch(a){if(d6(a))return d6(a)&&"AuthSessionMissingError"===a.name&&(await this._removeSession(),await eu(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:a});throw a}}async updateUser(a,b={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(a,b))}async _updateUser(a,b={}){try{return await this._useSession(async c=>{let{data:d,error:e}=c;if(e)throw e;if(!d.session)throw new ea;let f=d.session,g=null,h=null;"pkce"===this.flowType&&null!=a.email&&([g,h]=await eB(this.storage,this.storageKey));let{data:i,error:j}=await eK(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==b?void 0:b.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:g,code_challenge_method:h}),jwt:f.access_token,xform:eO});if(j)throw j;return f.user=i.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),this._returnResult({data:{user:f.user},error:null})})}catch(a){if(await eu(this.storage,`${this.storageKey}-code-verifier`),d6(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new ea;let b=Date.now()/1e3,c=b,d=!0,e=null,{payload:f}=ew(a.access_token);if(f.exp&&(d=(c=f.exp)<=b),d){let{data:b,error:c}=await this._callRefreshToken(a.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!b)return{data:{user:null,session:null},error:null};e=b}else{let{data:d,error:f}=await this._getUser(a.access_token);if(f)throw f;e={access_token:a.access_token,refresh_token:a.refresh_token,user:d.user,token_type:"bearer",expires_in:c-b,expires_at:c},await this._saveSession(e),await this._notifyAllSubscribers("SIGNED_IN",e)}return this._returnResult({data:{user:e.user,session:e},error:null})}catch(a){if(d6(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async b=>{var c;if(!a){let{data:d,error:e}=b;if(e)throw e;a=null!=(c=d.session)?c:void 0}if(!(null==a?void 0:a.refresh_token))throw new ea;let{data:d,error:e}=await this._callRefreshToken(a.refresh_token);return e?this._returnResult({data:{user:null,session:null},error:e}):d?this._returnResult({data:{user:d.user,session:d},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(a){if(d6(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async _getSessionFromURL(a,b){try{throw new ed("No browser detected.")}catch(a){if(d6(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(a){return"function"==typeof this.detectSessionInUrl?this.detectSessionInUrl(new URL(window.location.href),a):!!(a.access_token||a.error_description)}async _isPKCECallback(a){let b=await et(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&b)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async b=>{var c;let{data:d,error:e}=b;if(e)return this._returnResult({error:e});let f=null==(c=d.session)?void 0:c.access_token;if(f){let{error:b}=await this.admin.signOut(f,a);if(b&&!(d6(b)&&"AuthApiError"===b.name&&(404===b.status||401===b.status||403===b.status)))return this._returnResult({error:b})}return"others"!==a&&(await this._removeSession(),await eu(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(a){let b=Symbol("auth-callback"),c={id:b,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",b),this.stateChangeEmitters.delete(b)}};return this._debug("#onAuthStateChange()","registered callback with id",b),this.stateChangeEmitters.set(b,c),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(b)})})(),{data:{subscription:c}}}async _emitInitialSession(a){return await this._useSession(async b=>{var c,d;try{let{data:{session:d},error:e}=b;if(e)throw e;await (null==(c=this.stateChangeEmitters.get(a))?void 0:c.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",a,"session",d)}catch(b){await (null==(d=this.stateChangeEmitters.get(a))?void 0:d.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",b),console.error(b)}})}async resetPasswordForEmail(a,b={}){let c=null,d=null;"pkce"===this.flowType&&([c,d]=await eB(this.storage,this.storageKey,!0));try{return await eK(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:c,code_challenge_method:d,gotrue_meta_security:{captcha_token:b.captchaToken}},headers:this.headers,redirectTo:b.redirectTo})}catch(a){if(await eu(this.storage,`${this.storageKey}-code-verifier`),d6(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var a;try{let{data:b,error:c}=await this.getUser();if(c)throw c;return this._returnResult({data:{identities:null!=(a=b.user.identities)?a:[]},error:null})}catch(a){if(d6(a))return this._returnResult({data:null,error:a});throw a}}async linkIdentity(a){return"token"in a?this.linkIdentityIdToken(a):this.linkIdentityOAuth(a)}async linkIdentityOAuth(a){try{let{data:b,error:c}=await this._useSession(async b=>{var c,d,e,f,g;let{data:h,error:i}=b;if(i)throw i;let j=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:null==(c=a.options)?void 0:c.redirectTo,scopes:null==(d=a.options)?void 0:d.scopes,queryParams:null==(e=a.options)?void 0:e.queryParams,skipBrowserRedirect:!0});return await eK(this.fetch,"GET",j,{headers:this.headers,jwt:null!=(g=null==(f=h.session)?void 0:f.access_token)?g:void 0})});if(c)throw c;return this._returnResult({data:{provider:a.provider,url:null==b?void 0:b.url},error:null})}catch(b){if(d6(b))return this._returnResult({data:{provider:a.provider,url:null},error:b});throw b}}async linkIdentityIdToken(a){return await this._useSession(async b=>{var c;try{let{error:d,data:{session:e}}=b;if(d)throw d;let{options:f,provider:g,token:h,access_token:i,nonce:j}=a,{data:k,error:l}=await eK(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:null!=(c=null==e?void 0:e.access_token)?c:void 0,body:{provider:g,id_token:h,access_token:i,nonce:j,link_identity:!0,gotrue_meta_security:{captcha_token:null==f?void 0:f.captchaToken}},xform:eM});if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!k||!k.session||!k.user)return this._returnResult({data:{user:null,session:null},error:new eb});return k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("USER_UPDATED",k.session)),this._returnResult({data:k,error:l})}catch(a){if(await eu(this.storage,`${this.storageKey}-code-verifier`),d6(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(a){try{return await this._useSession(async b=>{var c,d;let{data:e,error:f}=b;if(f)throw f;return await eK(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:null!=(d=null==(c=e.session)?void 0:c.access_token)?d:void 0})})}catch(a){if(d6(a))return this._returnResult({data:null,error:a});throw a}}async _refreshAccessToken(a){let b=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(b,"begin");try{var c,d;let e=Date.now();return await (c=async c=>(c>0&&await ex(200*Math.pow(2,c-1)),this._debug(b,"refreshing attempt",c),await eK(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:eM})),d=(a,b)=>{let c=200*Math.pow(2,a);return b&&eg(b)&&Date.now()+c-e<3e4},new Promise((a,b)=>{(async()=>{for(let e=0;e<1/0;e++)try{let b=await c(e);if(!d(e,null,b))return void a(b)}catch(a){if(!d(e,a))return void b(a)}})()}))}catch(a){if(this._debug(b,"error",a),d6(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(b,"end")}}_isValidSession(a){return"object"==typeof a&&null!==a&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,b){let c=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:b.redirectTo,scopes:b.scopes,queryParams:b.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",b,"url",c),{data:{provider:a,url:c},error:null}}async _recoverAndRefresh(){var a,b;let c="#_recoverAndRefresh()";this._debug(c,"begin");try{let d=await et(this.storage,this.storageKey);if(d&&this.userStorage){let b=await et(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!b&&(b={user:d.user},await es(this.userStorage,this.storageKey+"-user",b)),d.user=null!=(a=null==b?void 0:b.user)?a:eF()}else if(d&&!d.user&&!d.user){let a=await et(this.storage,this.storageKey+"-user");a&&(null==a?void 0:a.user)?(d.user=a.user,await eu(this.storage,this.storageKey+"-user"),await es(this.storage,this.storageKey,d)):d.user=eF()}if(this._debug(c,"session from storage",d),!this._isValidSession(d)){this._debug(c,"session is not valid"),null!==d&&await this._removeSession();return}let e=(null!=(b=d.expires_at)?b:1/0)*1e3-Date.now()<9e4;if(this._debug(c,`session has${e?"":" not"} expired with margin of 90000s`),e){if(this.autoRefreshToken&&d.refresh_token){let{error:a}=await this._callRefreshToken(d.refresh_token);a&&(console.error(a),eg(a)||(this._debug(c,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(d.user&&!0===d.user.__isUserNotAvailableProxy)try{let{data:a,error:b}=await this._getUser(d.access_token);!b&&(null==a?void 0:a.user)?(d.user=a.user,await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)):this._debug(c,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(c,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",d)}catch(a){this._debug(c,"error",a),console.error(a);return}finally{this._debug(c,"end")}}async _callRefreshToken(a){var b,c;if(!a)throw new ea;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let d=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(d,"begin");try{this.refreshingDeferred=new ev;let{data:b,error:c}=await this._refreshAccessToken(a);if(c)throw c;if(!b.session)throw new ea;await this._saveSession(b.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",b.session);let d={data:b.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(a){if(this._debug(d,"error",a),d6(a)){let c={data:null,error:a};return eg(a)||await this._removeSession(),null==(b=this.refreshingDeferred)||b.resolve(c),c}throw null==(c=this.refreshingDeferred)||c.reject(a),a}finally{this.refreshingDeferred=null,this._debug(d,"end")}}async _notifyAllSubscribers(a,b,c=!0){let d=`#_notifyAllSubscribers(${a})`;this._debug(d,"begin",b,`broadcast = ${c}`);try{this.broadcastChannel&&c&&this.broadcastChannel.postMessage({event:a,session:b});let d=[],e=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(a,b)}catch(a){d.push(a)}});if(await Promise.all(e),d.length>0){for(let a=0;a<d.length;a+=1)console.error(d[a]);throw d[0]}}finally{this._debug(d,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0,await eu(this.storage,`${this.storageKey}-code-verifier`);let b=Object.assign({},a),c=b.user&&!0===b.user.__isUserNotAvailableProxy;if(this.userStorage){!c&&b.user&&await es(this.userStorage,this.storageKey+"-user",{user:b.user});let a=Object.assign({},b);delete a.user;let d=eG(a);await es(this.storage,this.storageKey,d)}else{let a=eG(b);await es(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await eu(this.storage,this.storageKey),await eu(this.storage,this.storageKey+"-code-verifier"),await eu(this.storage,this.storageKey+"-user"),this.userStorage&&await eu(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()"),this.visibilityChangedCallback,this.visibilityChangedCallback=null}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let a=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=a,a&&"object"==typeof a&&"function"==typeof a.unref?a.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(a),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let a=Date.now();try{return await this._useSession(async b=>{let{data:{session:c}}=b;if(!c||!c.refresh_token||!c.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");let d=Math.floor((1e3*c.expires_at-a)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${d} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),d<=3&&await this._callRefreshToken(c.refresh_token)})}catch(a){console.error("Auto refresh tick failed with error. This is likely a transient error.",a)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof eV)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){return this._debug("#_handleVisibilityChange()"),this.autoRefreshToken&&this.startAutoRefresh(),!1}async _onVisibilityChanged(a){let b=`#_onVisibilityChanged(${a})`;this._debug(b,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"!==document.visibilityState?this._debug(b,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting"):await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,b,c){let d=[`provider=${encodeURIComponent(b)}`];if((null==c?void 0:c.redirectTo)&&d.push(`redirect_to=${encodeURIComponent(c.redirectTo)}`),(null==c?void 0:c.scopes)&&d.push(`scopes=${encodeURIComponent(c.scopes)}`),"pkce"===this.flowType){let[a,b]=await eB(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(b)}`});d.push(c.toString())}if(null==c?void 0:c.queryParams){let a=new URLSearchParams(c.queryParams);d.push(a.toString())}return(null==c?void 0:c.skipBrowserRedirect)&&d.push(`skip_http_redirect=${c.skipBrowserRedirect}`),`${a}?${d.join("&")}`}async _unenroll(a){try{return await this._useSession(async b=>{var c;let{data:d,error:e}=b;return e?this._returnResult({data:null,error:e}):await eK(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:null==(c=null==d?void 0:d.session)?void 0:c.access_token})})}catch(a){if(d6(a))return this._returnResult({data:null,error:a});throw a}}async _enroll(a){try{return await this._useSession(async b=>{var c,d;let{data:e,error:f}=b;if(f)return this._returnResult({data:null,error:f});let g=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},"phone"===a.factorType?{phone:a.phone}:"totp"===a.factorType?{issuer:a.issuer}:{}),{data:h,error:i}=await eK(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:null==(c=null==e?void 0:e.session)?void 0:c.access_token});return i?this._returnResult({data:null,error:i}):("totp"===a.factorType&&"totp"===h.type&&(null==(d=null==h?void 0:h.totp)?void 0:d.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(a){if(d6(a))return this._returnResult({data:null,error:a});throw a}}async _verify(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async b=>{var c,d,e;let{data:f,error:g}=b;if(g)return this._returnResult({data:null,error:g});let h=Object.assign({challenge_id:a.challengeId},"webauthn"in a?{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_response:"create"===a.webauthn.type?(d=a.webauthn.credential_response,"toJSON"in d&&"function"==typeof d.toJSON?d.toJSON():{id:d.id,rawId:d.id,response:{attestationObject:eq(new Uint8Array(d.response.attestationObject)),clientDataJSON:eq(new Uint8Array(d.response.clientDataJSON))},type:"public-key",clientExtensionResults:d.getClientExtensionResults(),authenticatorAttachment:null!=(e=d.authenticatorAttachment)?e:void 0}):function(a){var b;if("toJSON"in a&&"function"==typeof a.toJSON)return a.toJSON();let c=a.getClientExtensionResults(),d=a.response;return{id:a.id,rawId:a.id,response:{authenticatorData:eq(new Uint8Array(d.authenticatorData)),clientDataJSON:eq(new Uint8Array(d.clientDataJSON)),signature:eq(new Uint8Array(d.signature)),userHandle:d.userHandle?eq(new Uint8Array(d.userHandle)):void 0},type:"public-key",clientExtensionResults:c,authenticatorAttachment:null!=(b=a.authenticatorAttachment)?b:void 0}}(a.webauthn.credential_response)})}:{code:a.code}),{data:i,error:j}=await eK(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:h,headers:this.headers,jwt:null==(c=null==f?void 0:f.session)?void 0:c.access_token});return j?this._returnResult({data:null,error:j}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),this._returnResult({data:i,error:j}))})}catch(a){if(d6(a))return this._returnResult({data:null,error:a});throw a}})}async _challenge(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async b=>{var c;let{data:d,error:e}=b;if(e)return this._returnResult({data:null,error:e});let f=await eK(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:a,headers:this.headers,jwt:null==(c=null==d?void 0:d.session)?void 0:c.access_token});if(f.error)return f;let{data:g}=f;if("webauthn"!==g.type)return{data:g,error:null};switch(g.webauthn.type){case"create":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:function(a){if(!a)throw Error("Credential creation options are required");if("undefined"!=typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(a);let{challenge:b,user:c,excludeCredentials:d}=a,e=az(a,["challenge","user","excludeCredentials"]),f=ep(b).buffer,g=Object.assign(Object.assign({},c),{id:ep(c.id).buffer}),h=Object.assign(Object.assign({},e),{challenge:f,user:g});if(d&&d.length>0){h.excludeCredentials=Array(d.length);for(let a=0;a<d.length;a++){let b=d[a];h.excludeCredentials[a]=Object.assign(Object.assign({},b),{id:ep(b.id).buffer,type:b.type||"public-key",transports:b.transports})}}return h}(g.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:function(a){if(!a)throw Error("Credential request options are required");if("undefined"!=typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(a);let{challenge:b,allowCredentials:c}=a,d=az(a,["challenge","allowCredentials"]),e=ep(b).buffer,f=Object.assign(Object.assign({},d),{challenge:e});if(c&&c.length>0){f.allowCredentials=Array(c.length);for(let a=0;a<c.length;a++){let b=c[a];f.allowCredentials[a]=Object.assign(Object.assign({},b),{id:ep(b.id).buffer,type:b.type||"public-key",transports:b.transports})}}return f}(g.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(a){if(d6(a))return this._returnResult({data:null,error:a});throw a}})}async _challengeAndVerify(a){let{data:b,error:c}=await this._challenge({factorId:a.factorId});return c?this._returnResult({data:null,error:c}):await this._verify({factorId:a.factorId,challengeId:b.id,code:a.code})}async _listFactors(){var a;let{data:{user:b},error:c}=await this.getUser();if(c)return{data:null,error:c};let d={all:[],phone:[],totp:[],webauthn:[]};for(let c of null!=(a=null==b?void 0:b.factors)?a:[])d.all.push(c),"verified"===c.status&&d[c.factor_type].push(c);return{data:d,error:null}}async _getAuthenticatorAssuranceLevel(){var a,b;let{data:{session:c},error:d}=await this.getSession();if(d)return this._returnResult({data:null,error:d});if(!c)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:e}=ew(c.access_token),f=null;e.aal&&(f=e.aal);let g=f;return(null!=(b=null==(a=c.user.factors)?void 0:a.filter(a=>"verified"===a.status))?b:[]).length>0&&(g="aal2"),{data:{currentLevel:f,nextLevel:g,currentAuthenticationMethods:e.amr||[]},error:null}}async _getAuthorizationDetails(a){try{return await this._useSession(async b=>{let{data:{session:c},error:d}=b;return d?this._returnResult({data:null,error:d}):c?await eK(this.fetch,"GET",`${this.url}/oauth/authorizations/${a}`,{headers:this.headers,jwt:c.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new ea})})}catch(a){if(d6(a))return this._returnResult({data:null,error:a});throw a}}async _approveAuthorization(a,b){try{return await this._useSession(async b=>{let{data:{session:c},error:d}=b;if(d)return this._returnResult({data:null,error:d});if(!c)return this._returnResult({data:null,error:new ea});let e=await eK(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:c.access_token,body:{action:"approve"},xform:a=>({data:a,error:null})});return e.data&&e.data.redirect_url,e})}catch(a){if(d6(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(a,b){try{return await this._useSession(async b=>{let{data:{session:c},error:d}=b;if(d)return this._returnResult({data:null,error:d});if(!c)return this._returnResult({data:null,error:new ea});let e=await eK(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:c.access_token,body:{action:"deny"},xform:a=>({data:a,error:null})});return e.data&&e.data.redirect_url,e})}catch(a){if(d6(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async a=>{let{data:{session:b},error:c}=a;return c?this._returnResult({data:null,error:c}):b?await eK(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:b.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new ea})})}catch(a){if(d6(a))return this._returnResult({data:null,error:a});throw a}}async _revokeOAuthGrant(a){try{return await this._useSession(async b=>{let{data:{session:c},error:d}=b;return d?this._returnResult({data:null,error:d}):c?(await eK(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:c.access_token,query:{client_id:a.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ea})})}catch(a){if(d6(a))return this._returnResult({data:null,error:a});throw a}}async fetchJwk(a,b={keys:[]}){let c=b.keys.find(b=>b.kid===a);if(c)return c;let d=Date.now();if((c=this.jwks.keys.find(b=>b.kid===a))&&this.jwks_cached_at+6e5>d)return c;let{data:e,error:f}=await eK(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return e.keys&&0!==e.keys.length&&(this.jwks=e,this.jwks_cached_at=d,c=e.keys.find(b=>b.kid===a))?c:null}async getClaims(a,b={}){try{var c;let d,e=a;if(!e){let{data:a,error:b}=await this.getSession();if(b||!a.session)return this._returnResult({data:null,error:b});e=a.session.access_token}let{header:f,payload:g,signature:h,raw:{header:i,payload:j}}=ew(e);(null==b?void 0:b.allowExpired)||function(a){if(!a)throw Error("Missing exp claim");if(a<=Math.floor(Date.now()/1e3))throw Error("JWT has expired")}(g.exp);let k=!f.alg||f.alg.startsWith("HS")||!f.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(f.kid,(null==b?void 0:b.keys)?{keys:b.keys}:null==b?void 0:b.jwks);if(!k){let{error:a}=await this.getUser(e);if(a)throw a;return{data:{claims:g,header:f,signature:h},error:null}}let l=function(a){switch(a){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw Error("Invalid alg claim")}}(f.alg),m=await crypto.subtle.importKey("jwk",k,l,!0,["verify"]);if(!await crypto.subtle.verify(l,m,h,(c=`${i}.${j}`,d=[],!function(a,b){for(let c=0;c<a.length;c+=1){let d=a.charCodeAt(c);if(d>55295&&d<=56319){let b=(d-55296)*1024&65535;d=(a.charCodeAt(c+1)-56320&65535|b)+65536,c+=1}!function(a,b){if(a<=127)return b(a);if(a<=2047){b(192|a>>6),b(128|63&a);return}if(a<=65535){b(224|a>>12),b(128|a>>6&63),b(128|63&a);return}if(a<=1114111){b(240|a>>18),b(128|a>>12&63),b(128|a>>6&63),b(128|63&a);return}throw Error(`Unrecognized Unicode codepoint: ${a.toString(16)}`)}(d,b)}}(c,a=>d.push(a)),new Uint8Array(d))))throw new ei("Invalid JWT signature");return{data:{claims:g,header:f,signature:h},error:null}}catch(a){if(d6(a))return this._returnResult({data:null,error:a});throw a}}}e8.nextInstanceID={};let e9=e8,fa="";fa="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let fb={headers:{"X-Client-Info":`supabase-js-${fa}/2.89.0`}},fc={schema:"public"},fd={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},fe={};function ff(a){return(ff="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function fg(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function fh(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?fg(Object(c),!0).forEach(function(b){!function(a,b,c){var d;(d=function(a,b){if("object"!=ff(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=ff(d))return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(b,"string"),(b="symbol"==ff(d)?d:d+"")in a)?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c}(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):fg(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}var fi=class extends e9{constructor(a){super(a)}},fj=class{constructor(a,b,c){var d,e,f;this.supabaseUrl=a,this.supabaseKey=b;const g=function(a){let b=null==a?void 0:a.trim();if(!b)throw Error("supabaseUrl is required.");if(!b.match(/^https?:\/\//i))throw Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(b.endsWith("/")?b:b+"/")}catch(a){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}(a);if(!b)throw Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",g),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",g),this.storageUrl=new URL("storage/v1",g),this.functionsUrl=new URL("functions/v1",g);const h=`sb-${g.hostname.split(".")[0]}-auth-token`,i=function(a,b){var c,d;let{db:e,auth:f,realtime:g,global:h}=a,{db:i,auth:j,realtime:k,global:l}=b,m={db:fh(fh({},i),e),auth:fh(fh({},j),f),realtime:fh(fh({},k),g),storage:{},global:fh(fh(fh({},l),h),{},{headers:fh(fh({},null!=(c=null==l?void 0:l.headers)?c:{}),null!=(d=null==h?void 0:h.headers)?d:{})}),accessToken:async()=>""};return a.accessToken?m.accessToken=a.accessToken:delete m.accessToken,m}(null!=c?c:{},{db:fc,realtime:fe,auth:fh(fh({},fd),{},{storageKey:h}),global:fb});this.storageKey=null!=(d=i.auth.storageKey)?d:"",this.headers=null!=(e=i.global.headers)?e:{},i.accessToken?(this.accessToken=i.accessToken,this.auth=new Proxy({},{get:(a,b)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!=(f=i.auth)?f:{},this.headers,i.global.fetch),this.fetch=((a,b,c)=>{let d=c?(...a)=>c(...a):(...a)=>fetch(...a),e=Headers;return async(c,f)=>{var g;let h=null!=(g=await b())?g:a,i=new e(null==f?void 0:f.headers);return i.has("apikey")||i.set("apikey",a),i.has("Authorization")||i.set("Authorization",`Bearer ${h}`),d(c,fh(fh({},f),{},{headers:i}))}})(b,this._getAccessToken.bind(this),i.global.fetch),this.realtime=this._initRealtimeClient(fh({headers:this.headers,accessToken:this._getAccessToken.bind(this)},i.realtime)),this.accessToken&&this.accessToken().then(a=>this.realtime.setAuth(a)).catch(a=>console.warn("Failed to set initial Realtime auth token:",a)),this.rest=new cT(new URL("rest/v1",g).href,{headers:this.headers,schema:i.db.schema,fetch:this.fetch}),this.storage=new d_(this.storageUrl.href,this.headers,this.fetch,null==c?void 0:c.storage),i.accessToken||this._listenForAuthEvents()}get functions(){return new cM(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,b={},c={head:!1,get:!1,count:void 0}){return this.rest.rpc(a,b,c)}channel(a,b={config:{}}){return this.realtime.channel(a,b)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var a,b;if(this.accessToken)return await this.accessToken();let{data:c}=await this.auth.getSession();return null!=(a=null==(b=c.session)?void 0:b.access_token)?a:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:b,detectSessionInUrl:c,storage:d,userStorage:e,storageKey:f,flowType:g,lock:h,debug:i,throwOnError:j},k,l){let m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new fi({url:this.authUrl.href,headers:fh(fh({},m),k),storageKey:f,autoRefreshToken:a,persistSession:b,detectSessionInUrl:c,storage:d,userStorage:e,flowType:g,lock:h,debug:i,throwOnError:j,fetch:l,hasCustomAuthorizationHeader:Object.keys(this.headers).some(a=>"authorization"===a.toLowerCase())})}_initRealtimeClient(a){return new dc(this.realtimeUrl.href,fh(fh({},a),{},{params:fh(fh({},{apikey:this.supabaseKey}),null==a?void 0:a.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((a,b)=>{this._handleTokenChanged(a,"CLIENT",null==b?void 0:b.access_token)})}_handleTokenChanged(a,b,c){("TOKEN_REFRESHED"===a||"SIGNED_IN"===a)&&this.changedAccessToken!==c?(this.changedAccessToken=c,this.realtime.setAuth(c)):"SIGNED_OUT"===a&&(this.realtime.setAuth(),"STORAGE"==b&&this.auth.signOut(),this.changedAccessToken=void 0)}};(function(){if("undefined"==typeof process)return!1;let a=process.version;if(null==a)return!1;let b=a.match(/^v(\d+)\./);return!!b&&18>=parseInt(b[1],10)})()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");var fk=a.i(30037);fk.parse,fk.serialize;let fl={path:"/",sameSite:"lax",httpOnly:!1,maxAge:3456e4},fm=/^(.*)[.](0|[1-9][0-9]*)$/;function fn(a,b){if(a===b)return!0;let c=a.match(fm);return!!c&&c[1]===b}function fo(a,b,c){let d=c??3180,e=encodeURIComponent(b);if(e.length<=d)return[{name:a,value:b}];let f=[];for(;e.length>0;){let a=e.slice(0,d),b=a.lastIndexOf("%");b>d-3&&(a=a.slice(0,b));let c="";for(;a.length>0;)try{c=decodeURIComponent(a);break}catch(b){if(b instanceof URIError&&"%"===a.at(-3)&&a.length>3)a=a.slice(0,a.length-3);else throw b}f.push(c),e=e.slice(a.length)}return f.map((b,c)=>({name:`${a}.${c}`,value:b}))}async function fp(a,b){let c=await b(a);if(c)return c;let d=[];for(let c=0;;c++){let e=`${a}.${c}`,f=await b(e);if(!f)break;d.push(f)}return d.length>0?d.join(""):null}let fq="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),fr=" 	\n\r=".split(""),fs=(()=>{let a=Array(128);for(let b=0;b<a.length;b+=1)a[b]=-1;for(let b=0;b<fr.length;b+=1)a[fr[b].charCodeAt(0)]=-2;for(let b=0;b<fq.length;b+=1)a[fq[b].charCodeAt(0)]=b;return a})();function ft(a){let b=[],c=0,d=0;if(function(a,b){for(let c=0;c<a.length;c+=1){let d=a.charCodeAt(c);if(d>55295&&d<=56319){let b=(d-55296)*1024&65535;d=(a.charCodeAt(c+1)-56320&65535|b)+65536,c+=1}!function(a,b){if(a<=127)return b(a);if(a<=2047){b(192|a>>6),b(128|63&a);return}if(a<=65535){b(224|a>>12),b(128|a>>6&63),b(128|63&a);return}if(a<=1114111){b(240|a>>18),b(128|a>>12&63),b(128|a>>6&63),b(128|63&a);return}throw Error(`Unrecognized Unicode codepoint: ${a.toString(16)}`)}(d,b)}}(a,a=>{for(c=c<<8|a,d+=8;d>=6;){let a=c>>d-6&63;b.push(fq[a]),d-=6}}),d>0)for(c<<=6-d,d=6;d>=6;){let a=c>>d-6&63;b.push(fq[a]),d-=6}return b.join("")}function fu(a){let b=[],c=a=>{b.push(String.fromCodePoint(a))},d={utf8seq:0,codepoint:0},e=0,f=0;for(let b=0;b<a.length;b+=1){let g=fs[a.charCodeAt(b)];if(g>-1)for(e=e<<6|g,f+=6;f>=8;)(function(a,b,c){if(0===b.utf8seq){if(a<=127)return c(a);for(let c=1;c<6;c+=1)if((a>>7-c&1)==0){b.utf8seq=c;break}if(2===b.utf8seq)b.codepoint=31&a;else if(3===b.utf8seq)b.codepoint=15&a;else if(4===b.utf8seq)b.codepoint=7&a;else throw Error("Invalid UTF-8 sequence");b.utf8seq-=1}else if(b.utf8seq>0){if(a<=127)throw Error("Invalid UTF-8 sequence");b.codepoint=b.codepoint<<6|63&a,b.utf8seq-=1,0===b.utf8seq&&c(b.codepoint)}})(e>>f-8&255,d,c),f-=8;else if(-2===g)continue;else throw Error(`Invalid Base64-URL character "${a.at(b)}" at position ${b}`)}return b.join("")}let fv="base64-";async function fw({getAll:a,setAll:b,setItems:c,removedItems:d},e){let f=e.cookieEncoding,g=e.cookieOptions??null,h=await a([...c?Object.keys(c):[],...d?Object.keys(d):[]]),i=h?.map(({name:a})=>a)||[],j=Object.keys(d).flatMap(a=>i.filter(b=>fn(b,a))),k=Object.keys(c).flatMap(a=>{let b=new Set(i.filter(b=>fn(b,a))),d=c[a];"base64url"===f&&(d=fv+ft(d));let e=fo(a,d);return e.forEach(a=>{b.delete(a.name)}),j.push(...b),e}),l={...fl,...g,maxAge:0},m={...fl,...g,maxAge:fl.maxAge};delete l.name,delete m.name,await b([...j.map(a=>({name:a,value:"",options:l})),...k.map(({name:a,value:b})=>({name:a,value:b,options:m}))])}if(a.i(99932),"undefined"!=typeof process&&process.env?.npm_package_name){let a=process.env.npm_package_name;["@supabase/auth-helpers-nextjs","@supabase/auth-helpers-react","@supabase/auth-helpers-remix","@supabase/auth-helpers-sveltekit"].includes(a)&&console.warn(`

   IMPORTANT: Package Consolidation Notice                                
                                                                            
 The ${a.padEnd(35)} package name is deprecated.  
                                                                            
 You are now using @supabase/ssr - a unified solution for all frameworks.  
                                                                            
 The auth-helpers packages have been consolidated into @supabase/ssr       
 to provide better maintenance and consistent APIs across frameworks.      
                                                                            
 Please update your package.json to use @supabase/ssr directly:            
   npm uninstall ${a.padEnd(42)} 
   npm install @supabase/ssr                                               
                                                                            
 For more information, visit:                                              
 https://supabase.com/docs/guides/auth/server-side                         

    `)}var fx=a.i(65071),fy=a.i(9672),fz=a.i(47087);function fA(){let[a,b]=(0,L.useState)([]),[c,d]=(0,L.useState)([]),[e,f]=(0,L.useState)(!0),[g,h]=(0,L.useState)(!1),[i,j]=(0,L.useState)(!1),k=async()=>{let a=function(a,b,c){0;if(!a||!b)throw Error(`@supabase/ssr: Your project's URL and API key are required to create a Supabase client!

Check your Supabase project's API settings to find these values

https://supabase.com/dashboard/project/_/settings/api`);let{storage:d}=function(a,b){let c,d,e=a.cookies??null,f=a.cookieEncoding,g={},h={};if(e)if("get"in e){let a=async a=>{let b=a.flatMap(a=>[a,...Array.from({length:5}).map((b,c)=>`${a}.${c}`)]),c=[];for(let a=0;a<b.length;a+=1){let d=await e.get(b[a]);(d||"string"==typeof d)&&c.push({name:b[a],value:d})}return c};if(c=async b=>await a(b),"set"in e&&"remove"in e)d=async a=>{for(let b=0;b<a.length;b+=1){let{name:c,value:d,options:f}=a[b];d?await e.set(c,d,f):await e.remove(c,f)}};else if(b)d=async()=>{console.warn("@supabase/ssr: createServerClient was configured without set and remove cookie methods, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness. Consider switching to the getAll and setAll cookie methods instead of get, set and remove which are deprecated and can be difficult to use correctly.")};else throw Error("@supabase/ssr: createBrowserClient requires configuring a getAll and setAll cookie method (deprecated: alternatively both get, set and remove can be used)")}else if("getAll"in e)if(c=async()=>await e.getAll(),"setAll"in e)d=e.setAll;else if(b)d=async()=>{console.warn("@supabase/ssr: createServerClient was configured without the setAll cookie method, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness.")};else throw Error("@supabase/ssr: createBrowserClient requires configuring both getAll and setAll cookie methods (deprecated: alternatively both get, set and remove can be used)");else throw Error(`@supabase/ssr: ${b?"createServerClient":"createBrowserClient"} requires configuring getAll and setAll cookie methods (deprecated: alternatively use get, set and remove).`);else if(b||1)if(b)throw Error("@supabase/ssr: createServerClient must be initialized with cookie options that specify getAll and setAll functions (deprecated, not recommended: alternatively use get, set and remove)");else c=()=>[],d=()=>{throw Error("@supabase/ssr: createBrowserClient in non-browser runtimes (including Next.js pre-rendering mode) was not initialized cookie options that specify getAll and setAll functions (deprecated: alternatively use get, set and remove), but they were needed")};else c=()=>{let a;return Object.keys(a=(0,fk.parse)(document.cookie)).map(b=>({name:b,value:a[b]??""}))},d=a=>{a.forEach(({name:a,value:b,options:c})=>{document.cookie=(0,fk.serialize)(a,b,c)})};return b?{getAll:c,setAll:d,setItems:g,removedItems:h,storage:{isServer:!0,getItem:async a=>{if("string"==typeof g[a])return g[a];if(h[a])return null;let b=await c([a]),d=await fp(a,async a=>{let c=b?.find(({name:b})=>b===a)||null;return c?c.value:null});if(!d)return null;let e=d;return"string"==typeof d&&d.startsWith(fv)&&(e=fu(d.substring(fv.length))),e},setItem:async(b,e)=>{b.endsWith("-code-verifier")&&await fw({getAll:c,setAll:d,setItems:{[b]:e},removedItems:{}},{cookieOptions:a?.cookieOptions??null,cookieEncoding:f}),g[b]=e,delete h[b]},removeItem:async a=>{delete g[a],h[a]=!0}}}:{getAll:c,setAll:d,setItems:g,removedItems:h,storage:{isServer:!1,getItem:async a=>{let b=await c([a]),d=await fp(a,async a=>{let c=b?.find(({name:b})=>b===a)||null;return c?c.value:null});if(!d)return null;let e=d;return d.startsWith(fv)&&(e=fu(d.substring(fv.length))),e},setItem:async(b,e)=>{let g=await c([b]),h=new Set((g?.map(({name:a})=>a)||[]).filter(a=>fn(a,b))),i=e;"base64url"===f&&(i=fv+ft(e));let j=fo(b,i);j.forEach(({name:a})=>{h.delete(a)});let k={...fl,...a?.cookieOptions,maxAge:0},l={...fl,...a?.cookieOptions,maxAge:fl.maxAge};delete k.name,delete l.name;let m=[...[...h].map(a=>({name:a,value:"",options:k})),...j.map(({name:a,value:b})=>({name:a,value:b,options:l}))];m.length>0&&await d(m)},removeItem:async b=>{let e=await c([b]),f=(e?.map(({name:a})=>a)||[]).filter(a=>fn(a,b)),g={...fl,...a?.cookieOptions,maxAge:0};delete g.name,f.length>0&&await d(f.map(a=>({name:a,value:"",options:g})))}}}}({...void 0,cookieEncoding:(void 0)??"base64url"},!1),e=new fj(a,b,{...void 0,global:{...void 0,headers:{...void 0,"X-Client-Info":"supabase-ssr/0.8.0 createBrowserClient"}},auth:{...void 0,flowType:"pkce",autoRefreshToken:!1,detectSessionInUrl:!1,persistSession:!0,storage:d}});return e}(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY),{data:c,error:d}=await a.from("projects").select("*").order("created_at",{ascending:!1});d?console.error("Error fetching projects:",d):b(c||[]),f(!1)},l=async()=>{let a=await cH();a.success&&d(a.data)};(0,L.useEffect)(()=>{k(),l()},[]);let m=a=>{b(b=>b.filter(b=>b.id!==a))},n=()=>{k()},o=()=>{l()},p=async()=>{await cG()};return(0,K.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,K.jsx)("header",{className:"border-b bg-card sticky top-0 z-10",children:(0,K.jsxs)("div",{className:"container mx-auto px-4 py-4 flex items-center justify-between",children:[(0,K.jsxs)("div",{className:"flex items-center gap-4",children:[(0,K.jsx)("h1",{className:"text-2xl font-bold",children:"Admin Dashboard"}),(0,K.jsx)(M.Button,{asChild:!0,variant:"ghost",size:"sm",children:(0,K.jsxs)(fx.default,{href:"/",children:[(0,K.jsx)(Q,{className:"mr-2 h-4 w-4"}),"View Site"]})})]}),(0,K.jsxs)("div",{className:"flex items-center gap-2",children:[(0,K.jsx)(cB.ThemeToggle,{}),(0,K.jsxs)(M.Button,{onClick:()=>h(!0),size:"sm",children:[(0,K.jsx)(O,{className:"mr-2 h-4 w-4"}),"Add Project"]}),(0,K.jsxs)(M.Button,{onClick:p,variant:"outline",size:"sm",children:[(0,K.jsx)(P,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]})}),(0,K.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,K.jsx)("div",{className:"mb-8",children:(0,K.jsx)(fy.AdBanner,{})}),(0,K.jsxs)("div",{className:"mb-12",children:[(0,K.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,K.jsxs)("div",{children:[(0,K.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Manage Projects"}),(0,K.jsx)("p",{className:"text-muted-foreground",children:"Add, edit, or remove projects from your portfolio."})]}),(0,K.jsx)("div",{className:"hidden md:block scale-50 origin-right",children:(0,K.jsx)(fy.AdBanner,{})})]}),e?(0,K.jsx)("div",{className:"text-center py-12",children:(0,K.jsx)("p",{className:"text-muted-foreground",children:"Loading projects..."})}):0===a.length?(0,K.jsxs)("div",{className:"text-center py-12",children:[(0,K.jsx)("p",{className:"text-muted-foreground mb-4",children:"No projects yet. Add your first project to get started."}),(0,K.jsxs)(M.Button,{onClick:()=>h(!0),children:[(0,K.jsx)(O,{className:"mr-2 h-4 w-4"}),"Add Project"]})]}):(0,K.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[a.map(a=>(0,K.jsx)(cs,{project:a,onDeleted:m,onUpdated:n},a.id)),(0,K.jsxs)("div",{className:"border border-dashed border-primary/50 rounded-xl p-4 flex flex-col items-center justify-center bg-primary/5 min-h-[200px]",children:[(0,K.jsx)("span",{className:"text-[10px] uppercase font-bold text-primary mb-2",children:"Internal Ad"}),(0,K.jsx)(fy.AdBanner,{})]})]})]}),(0,K.jsx)("div",{className:"my-12",children:(0,K.jsx)(fy.AdBanner,{})}),(0,K.jsx)(cF,{className:"my-8"}),(0,K.jsxs)("div",{children:[(0,K.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,K.jsxs)("div",{children:[(0,K.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Manage Admins"}),(0,K.jsx)("p",{className:"text-muted-foreground",children:"Add or remove admin accounts."})]}),(0,K.jsxs)(M.Button,{onClick:()=>j(!0),size:"sm",children:[(0,K.jsx)(R,{className:"mr-2 h-4 w-4"}),"Add Admin"]})]}),0===c.length?(0,K.jsx)("div",{className:"text-center py-12",children:(0,K.jsx)("p",{className:"text-muted-foreground mb-4",children:"No admins found."})}):(0,K.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[c.map(a=>(0,K.jsx)(cA,{admin:a,onDeleted:o},a.id)),(0,K.jsxs)("div",{className:"border border-dashed border-accent/50 rounded-xl p-4 flex flex-col items-center justify-center bg-accent/5",children:[(0,K.jsx)(fy.AdBanner,{}),(0,K.jsx)("span",{className:"text-[10px] uppercase font-bold text-accent mt-2",children:"Sponsored Admin"})]})]})]}),(0,K.jsx)("div",{className:"mt-12",children:(0,K.jsx)(fy.AdBanner,{})})]}),(0,K.jsx)(bY,{open:g,onOpenChange:h,onSuccess:k}),(0,K.jsx)(cw,{open:i,onOpenChange:j,onSuccess:l}),(0,K.jsx)(fz.ClientOnly,{children:(0,K.jsx)("div",{className:"fixed bottom-4 right-4 z-50 scale-75 origin-bottom-right",children:(0,K.jsx)(fy.AdBanner,{})})})]})}a.s(["default",()=>fA],14466)}];

//# sourceMappingURL=Desktop_Code_Newer_Projet-Perso_portfolio-new_New-Portfolio_e77ccb9f._.js.map